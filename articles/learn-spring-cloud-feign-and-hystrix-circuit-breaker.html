<!DOCTYPE html>
<html lang="en-US">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Learning about Spring Cloud Feign and Hystrix Circuit Breaker</title>
    <meta name="description" content="In this article, you’ll learn about Anatomy and Implementation of “Spring Cloud Feign” and “Hystrix Circuit Breaker”." />
    <meta name="keywords" content="Spring Cloud Netflix, Hystrix, Circuit Breaker pattern, Spring boot" />
    <link rel="canonical" href="https://www.nexsoftsys.com/articles/learn-spring-cloud-feign-and-hystrix-circuit-breaker.html" />
    
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Learning about Spring Cloud Feign and Hystrix Circuit Breaker" />
    <meta property="og:description" content="In this article, you’ll learn about Anatomy and Implementation of “Spring Cloud Feign” and “Hystrix Circuit Breaker”." />
    <meta property="og:url" content="https://www.nexsoftsys.com/articles/learn-spring-cloud-feign-and-hystrix-circuit-breaker.html" />
    <meta property="og:site_name" content="NEX Softsys" />
    <meta property="article:publisher" content="https://www.facebook.com/NexSoftSys/" />
    <meta property="article:section" content="Trending" />
    <meta property="og:image" content="https://www.nexsoftsys.com/articles/images/Spring-Cloud-Feign-and-Hystrix-Circuit-Breaker.jpg" />
    <meta property="og:image:secure_url" content="https://www.nexsoftsys.com/articles/images/Spring-Cloud-Feign-and-Hystrix-Circuit-Breaker.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:description" content="In this article, you’ll learn about Anatomy and Implementation of “Spring Cloud Feign” and “Hystrix Circuit Breaker”." />
    <meta name="twitter:title" content="Learning about Spring Cloud Feign and Hystrix Circuit Breaker" />
    <meta name="twitter:site" content="@nexsoftsys" />
    <meta name="twitter:image" content="https://www.nexsoftsys.com/articles/images/Spring-Cloud-Feign-and-Hystrix-Circuit-Breaker.jpg" />
    <meta name="twitter:creator" content="@nexsoftsys" />

    <link type="image/x-icon" href="../images/favicon.ico" rel="shortcut icon" />
    <link rel="apple-touch-icon" sizes="57x57" href="../images/apple-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="../images/apple-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="../images/apple-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="../images/apple-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="../images/apple-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="../images/apple-icon-152x152.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="../images/apple-icon-180x180.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="../images/android-icon-192x192.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="../images/favicon-96x96.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16.png" />
    <link rel="manifest" href="../images/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="images/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />

    <!-- Google Analytics -->
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-64517863-1', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- Google Analytics /- -->

    <!-- Library -->
    <link rel="stylesheet" type="text/css" href="../css/lib.css">

    <!-- Custom - Common CSS -->
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <link rel="stylesheet" type="text/css" href="../css/navigation.css">
    <link rel="stylesheet" type="text/css" href="../style.css" />
    <noscript>
        <div class="ndiv">
            <div class="ntext">
                <b>JavaScript Required</b>
                <p>We're sorry, but we doesn't work properly without JavaScript enabled.</p>
            </div>
        </div>
    </noscript>
</head>

<body>
    <!-- Header Section -->
    <div id="return-to-top"><i class="fa fa-angle-up"></i></div>

    <header class="header_s">
        <!-- ===== Popup Box ===== -->
        <section class="top-box">
            <div class="container">
                <div class="row">
                    <div class="col-12 same-line">
                        <div class="contain-box">
                            <p>Looking for an Expert Development Team? Take two weeks Trial! <a href="javascript:;" id="myBtn">Try Now</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="modal" id="myModal">
            <div class="modal-content">
                <div class="modal-header">
                    <span class="close">&times;</span>
                    <strong>Free 2 Week Trial</strong>
                </div>
                <div class="modal-form">
                    <form>
                        <div class="form-group">
                            <label>Your Name *</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Name" placeholder="Your Name" />
                        </div>
                        <div class="form-group">
                            <label>Your Email *</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Email" placeholder="Your Email" />
                        </div>
                        <div class="form-group">
                            <label>Your Mobile *</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Phone" placeholder="Your Mobile" />
                        </div>
                        <div class="form-group">
                            <label>Subject</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Subject" placeholder="Subject" />
                            <input type="hidden" id="txt2Page" value="" />
                        </div>
                        <div class="form-group">
                            <label>Your Message</label>
                            <textarea class="form-control" cols="5" rows="5" placeholder="Your Message" id="txt2Message" name="message"></textarea>
                        </div>
                        <div class="form-group">
                            

<img id="imgCaptchaRFP" alt="captcha" src="" class="captcha-style" />
                            <input class="form-control captcha-txt" type="text" placeholder="Captcha" id="txt2Captcha" name="txtCaptcha" />
                        </div>
                    </form>
                </div>
                <div class="modal-footer text-center">
                    <button type="button" id="btn2WeekSubmit" value="Send" name="Submit">Send</button>
                    <p><span id="lbl2WeekInfo" class="lblblack"></span></p>
                </div>
            </div>
        </section>
        <!-- # -->
        <div class="container-fluid">
            <div class="menu-block">
                <div class="mobile-sticky-footer">
                    <a target="_blank" class="skype" href="skype:aegissoftware?call"><i class="fa fa-fw" aria-hidden="true" title="Skype"></i></a>
                    <a target="_blank" class="whatsapp" href="https://api.whatsapp.com/send?phone=919824127020&text=Hi&sbquo;&nbsp;I&nbsp;am&nbsp;Connect&nbsp;through&nbsp;your&nbsp;website"><i class="fa fa-fw" aria-hidden="true" title="Whatsapp"></i></a>
                    <a target="_blank" class="inquiry" href="tel:+16469710799"><i class="fa fa-fw" aria-hidden="true" title="Phone"></i></a>
                    <a target="_blank" class="case-studies" href="mailto:info@nexsoftsys.com"><i class="fa fa-fw" aria-hidden="true" title="Email"></i></a>
                    <a href="../rfp.html" class="client-speaks"><i class="fa fa-fw" aria-hidden="true" title="RFP"></i></a>
                </div>
                <div class="container">
                    <nav class="menu-navigation">
                        <div class="logo-block">
                            <a class="navbar-brand" href="/">
                                <img src="../images/logo.png" alt="logo" />
                            </a>
                        </div>
                        <a class="menuswitch" href="#">
                            <span class="menuline bar1"></span>
                            <span class="menuline bar2"></span>
                            <span class="menuline bar3"></span>
                        </a>
                        <div class="menu-collapse">
                            <ul class="navigation-menu">
                                <li><a href="/">Home</a></li>
                                <li><a href="../company.html">About Us</a></li>
                                <li class="dropdown">
                                    <i class="ddl-switch"></i>
                                    <a href="#">Services</a>
                                    <ul class="dropdown-menu">
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/application-development.html">Application Development</a></li>
                                            <li><a href="#">Digital Transformation</a></li>
                                            <li><a href="../services/software-consulting-services.html">Software Consulting Services</a></li>
                                            <li><a href="../services/software-it-outsourcing-services.html">Software IT Outsourcing</a></li>
                                            <li><a href="../services/offshore-development-center.html">Offshore Development</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/big-data-services.html">Big Data</a></li>
                                            <li><a href="../services/real-time-data-analytics-services.html">Real Time Analytics</a></li>
                                            <li><a href="#">Block Chain</a></li>
                                            <li><a href="../services/devops-consulting.html">DevOps</a></li>
                                            <li><a href="../services/offshore-qa-testing-services.html">QA and Testing Services</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/amazon-cloud-services.html">Amazon Cloud Services</a></li>
                                            <li><a href="../services/cloud-application-development.html">Cloud Application</a></li>
                                            <li><a href="../services/mobility-solutions.html">Enterprise Mobility</a></li>
                                            <li><a href="#">Business Intelligence</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/data-warehousing-solutions.html">Data ware Housing</a></li>
                                            <li><a href="#">Data Integration</a></li>
                                            <li><a href="../services/ETL-data-integration-services.html">ETL</a></li>
                                            <li><a href="#">Dashboards</a></li>
                                        </div>
                                    </ul>
                                </li>
                                <li class="dropdown">
                                    <i class="ddl-switch"></i>
                                    <a href="#">Technologies</a>
                                    <ul class="dropdown-menu two_col">
                                        <div class="dropdown-menubox">
                                            <li><a href="../technologies/java-application-development.html">Java</a></li>
                                            <li><a href="../technologies/python-development-services.html">Python</a></li>
                                            <li><a href="../technologies/scala-development.html">Scala</a></li>
                                            <li><a href="../technologies/magento-ecommerce.html">Magento</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../technologies/android-app-development.html">Android</a></li>
                                            <li><a href="../technologies/ios-application-development.html">iOS</a></li>
                                            <li><a href="../technologies/pentaho-BI-Services.html">Pentaho BI</a></li>
                                        </div>
                                        <div class="dropdown-menubox microsoft_nested">
                                            <li class="full_width"><strong>Microsoft</strong></li>
                                            <li><a href="../technologies/net-application-development.html">.Net Development</a></li>
                                            <li><a href="../technologies/microsoft-dynamics-365.html">Dynamics 365</a></li>
                                            <li><a href="../technologies/dynamics-365-business-central-solutions-development.html">Dynamics 365 Business Central</a></li>
                                            <li><a href="../technologies/dynamics365-finance-and-operations.html">Dynamics 365 Finance &amp; Operations</a></li>
                                            <li><a href="../technologies/microsoft-dynamics-crm-consulting.html">Dynamics CRM</a></li>
                                            <li><a href="#">Power BI</a></li>
                                        </div>
                                    </ul>
                                </li>
                                <li><a href="/articles/">Blog</a></li>
                                <li><a href="../contact.html" class="menu-box">Contact Us</a></li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <!-- Header Section /- -->

    <div class="b-notification-bar">
        <!-- Social Links -->
        <ul class="btnlist">
            <li class="item skype">
                <a href="skype:aegissoftware?call">
                    <div class="sticky-box">
                        <p><i class="fa fa-skype"></i></p>
                        <p>Skype</p>
                    </div>
                </a>
            </li>
        </ul>
        <!-- # Social Links -->

        <!-- Inquiry Form -->
        <ul class="btnlist">
            <li class="item inquiry">
                <div id="inquiry_form" class="btn sticky-box">
                    <p><i class="fa fa-envelope" aria-hidden="true"></i></p>
                    <p>Quick Inquiry</p>
                </div>
                <div class="info-box inq">
                    <img src="images/close-icon.png" class="closeInquiry" alt="close" />
                    <strong class="title">Fill the details and We’ll get back to you soon</strong>
                    <form>
                        <div class="inquiry-box">
                            <div class="form-group fullwidth">
                                <textarea class="form-control" id="txtcomments" placeholder="Tell us your requirements"></textarea>
                            </div>
                            <div class="form-group-block">
                                <div class="form-group">
                                    <input class="form-control" id="txtphone" placeholder="Phone" type="text" onkeydown="javascript:backspacerDOWN(this, event);" onkeyup="javascript:backspacerUP(this, event);">
                                </div>
                                <div class="form-group">
                                    <input class="form-control" id="txtemail" placeholder="Email" type="email">
                                </div>
                                <div class="form-group">
                                    <input class="form-control" id="txtskype" placeholder="Skype" type="text">
                                </div>
                                <div class="form-group">
                                    <img id="imgCaptcha" alt="captcha" src="/Captcha.ashx" />
                                    <input class="form-control" type="text" placeholder="Captcha" id="txtCaptcha" name="txtCaptcha" />
                                </div>
                                <div class="form-group Clear">
                                    <button type="button" id="btnSubmit" value="Submit" name="Submit" class="btn-submit">Submit</button>
                                </div>
                                <div class="form-group Clear">
                                    <span id="lblInfo"> </span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </li>
        </ul>
        <!-- Inquiry Form /- -->
        <!--Btns-->
        <ul class="btnlist">
            <li class="item case-studies">
                <div class="btn sticky-box" onClick="window.location.href='../casestudy/java/java-case-studies.html'">
                    <p><i class="fa fa-check-square-o" aria-hidden="true"></i></p>
                    <p>Case Studies</p>
                </div>
            </li>
            <li class="item client-speaks">
                <div class="btn sticky-box" onClick="window.location.href='../testimonials/java-testimonials.html'">
                    <p><i class="fa fa-smile-o" aria-hidden="true"></i></p>
                    <p>Client Speaks</p>
                </div>
            </li>
        </ul>
        <!--Btns-->
    </div>

    <div class="Inner-Banner">
        <div class="Page-Size">
            <h1>A Complete Guide about Spring Cloud Feign and Hystrix Circuit Breaker</h1>
        </div>
    </div>
    <!--Web-Banner-->

    <div class="Page-Size">
        <div class="Text Width-100 margh2">
            <h2>Introduction</h2>
            <div class="single-article-img"><img src="images/Spring-Cloud-Feign-and-Hystrix-Circuit-Breaker.jpg" alt="Hystrix Circuit Breaker" /></div>
            <p>I am going to explain how you can be able to create declarative Rest Clients with Feign. And will illustrate how you will be able to call REST services using the Feign libraries. The interesting thing is that you can easily understand from this article that how Feign, Ribbon, and Eureka collaborate. If you do not know about Ribbon and Eureka, then please refer to our specific blogs on Eureka Service Discovery and Spring Ribbon.</p>
            <h3>What is Feign?</h3>
            <p>Feign is another part of the Netflix open-source software library i.e. easily usable within Spring Cloud. Feign allows us to write calls to Restful Services using a declarative style that results in no actual implementation code. Please be clear that here I am not talking about server-side code. I am referring to the client-side code that makes a call to server-side code that might be written in any technology or any programming languages.</p>
            <p>Feign declarative client is even easier than the “RestTemplate” that we normally use to call rest services. Spring Cloud provides an easy wrapper for using Feign. Now, I want to give you an example of RestClient i.e. part of the Spring framework. Please look at the below example below code</p>
<xmp>
RestTemplate tp = new RestTemplate(); 
    String url = “http://inventoryService/{0};// This is the target url with the placeholder 
    String s = tp.getForObject(url, String.class, 11)// Calls the URL, placeholder value is provided 11.
    // Template takes care of all HTTP and type conversion
</xmp>
            <ul class="listing">
                <li>See the first line where I obtain a rest template. We can do this by dependency Injection also. The next line is a string that represents a URL of a service that we would be calling.</li>
                <li>In the next line, I have used the getForObject() method and this results in the rest template making an HTTP get a call to the URL supplied in that first parameter. The second parameter in the getForObject() method is the expected data type of the return value or response. So, the template will instantiate an object if this class and will populate based on the return result. The result could be JSON or XML or some other format. The template will use automatically the correct HTTP message converter to handle all of the data type conversion.</li>
                <li>But, see there is nothing in the code to say whether we want JSON or XML as response format. The last parameter in the method is the argument that is going to be substituted in the placeholder in the URL string. This rest template will take care of the URL encoding.</li>
            </ul>
            <p>Now, Feign is an alternative to technology like the RestTemplate.</p>
            <h3>How Feign Works?</h3>
            <ul class="listing">
                <li>We can work with Feign by defining one or more Java interfaces for our REST client code. Within these interfaces, we have to define method signatures for the rest call that we would make. Then we have to annotate that interface with Feign annotation that describes the actual service call. Then next part is we have to annotate the individual methods with the Spring MVC annotation that describes how the service is defined on the server-side. This part is pluggable. If you prefer to use JAX/RS annotations, then you can be able to do that. But I will give an example with Spring MVC only.</li>
                <li>Now at the run time, when application starts, it will notice the Feign interfaces defined and during the application startup, Feign will automatically provide implementations of the interfaces that we have defined. And these automatic implementations will contain all of the code to make the remote calls and handle the response. To use these implementations, you have to do dependency injection of these interfaces where ever you need them. So, please see the below code example:
<xmp>
@FeignClient(url = "localhost:8080/warehouse") //Marks interface to be implemented by Feign
public Interface InventoryClient {
    @GetMapping("/inventory") // Spring MVC get Mapping
    List < Item > getItems();

    @PostMapping("/inventory/{sku}") // Spring MVC Post Mapping
    void update(@PathVariable("sku") Long sku, @RequestBody Item item);
}
</xmp>
                </li>
                <li>So, notice the above code image. Here “InventoryClient” is an interface, not a class. Now, see the @FeignClient annotation. This marks this interface for special use by Feign. In the annotation, we have provided the URL and this URL is nothing but the base URL of the warehouse service we will be calling. In my code, see the 1st method i.e. getItems() method. The name of the method is not relevant here but the parameters and return type are important. This getItem() method takes no parameter but is expected to return a list of Item objects.</li>
                <li>The main part is the “@RequestMapping” annotation. As you will be aware of this standard spring MVC annotation. It is ordinarily used on the server-side to explain what kind of incoming HTTP requests that a controller method should respond to. But in our Feign client case, it is used on the client-side to describe to feign that it needs to make the HTTP get a call to the “/inventory” resource. We are using these annotations to describe what the rest call looks like.</li>
                <li>Now, look at the next method i.e. update () method, It represents a post request to “/inventory/ {sku}” where SKU is a variable (SKU means stock keeping unit). The body is expected to contain a JSON representation of an item object. It is not intended to return a result when it is successful. So, you can see in the above code snippet image that we have used the method signature and annotations to simply describe the API that we will be invoking.</li>
            </ul>
            <p><strong>Feign Runtime Implementations:</strong></p>
            <p>We have to enable Feign functionality via the “@EnableFeignClients” annotation in one of our spring configuration classes. When the application starts up, the Feign libraries will see the annotations and provide runtime implementations of exactly what we told it to build. Please see the below example:</p>
<xmp>
@SpringBootApplication
@EnableFeignClients // Spring will seek interfaces and implement them
Public class Application{ }
</xmp>
            <h3>What does @EnableFeignClients annotation do Internally?</h3>
            <p>Before the application is running, what you would see in your codebase are the interfaces annotated with the “@FeignClient”. But when you run the application, Feign takes over and automatically provides the run time implementation (illustrated in the blue box in the below image). Please look at the below image.</p>
            <div class="single-article-img"><img src="images/hcb1.jpg" alt="Hystrix Circuit Breaker" /></div>
            <ul class="listing">
                <li>Please note that this is not the traditional code generation means some tool generating some code and we have to store it or maintain it. But this is different. This is an automatic implementation of an interface provided at startup time. There is no storage necessary. Now to use such a service, we have to simply auto wire it as a dependency into our other classes. We are coding to interface anyway and basing our dependency injection on the interface types rather than the concrete classes.</li>
                <li>I want to mention that using RestTemplate would require unit testing. The nice thing with Feign is that we can eliminate the need to do unit testing simply because we have no code to do unit testing on. However, with both approaches, we have to still perform the integration testing to make sure that all of our pieces work together correctly.</li>
                <li>In my previous example, I have illustrated a hardcoded URL in the @FeignClient annotation. But instead of that, we can replace this with the same “Client ID” values that we get from Eureka. All of the Eureka clients report in with their relevant identifiers. And we have to simply indicate which one we are looking for in the annotation. Example:
                    <ul class="listing">
                        <li>With Hardcoded URL:  @FeignClient(url=”localhost:8080/warehouse”)</li>
                        <li>Using Eureka “Client ID” instead:  @FeignClient(“warehouse”)</li>
                    </ul>
                </li>
                <li>In the above case using Eureka, we do not have to hardcode any configuring at all. So, I would say that the service discovery concept will work out very nicely.</li>
                <li>The other interesting thing is that Ribbon is automatically enabled. The ribbon is going to automatically load balance between the clients in the same pools. Suppose if Eureka provides me with multiple warehouse clients, then Ribbon is going to automatically round-robin between them. So, Eureka gives our application all “Clients” that match the given “Client ID”. So, Eureka handles the configuration of the servers that are calling, and Ribbon handles the load balancing and Feign handles the actual code.</li>
                <li>Feign starter is required at runtime. The “@FeignClient” annotation and the “@EnableFeignClients” annotation do not actually require any additional dependencies at compile-time, but they will require the below “spring-cloud-starter-openfeign” dependency at runtime and Feign integrates with Ribbon and Eureka automatically.</li>
            </ul>
            <p><strong>Feign dependency:</strong></p>
            <div class="single-article-img"><img src="images/hcb2.jpg" alt="Hystrix Circuit Breaker" /></div>
            <h4>Demo on Feign Declarative REST clients:</h4>
            <p>Before starting with Feign, first, you have to start your common-config-server and the common-eureka-server. You can visit our separate blog for the Eureka server setup and config server setup. Check the Eureka server running in your localhost.</p>
            <ul class="listing">
                <li>1.  First, create a Spring boot maven project. In the Pom file, add a dependency for “spring-cloud-starter-openfeign.”</li>
                <li>2.  In your Main Application configuration class and add the annotation @EnableFeignClients. Example:
                    <div class="single-article-img"><img src="images/hcb3.jpg" alt="Hystrix Circuit Breaker" /></div>
                    <ul class="listing">
                        <li>
                            1. Then create a new interface in your demo package called “DemoClient” and annotate this class with @FeignClient annotation. Next, we have to provide the method signature that will be implemented by Feign and here we do not need to mention @ResponseBody annotation as this is implied. The main thing is we have to add a method with GetMapping to clarify that this is a GET request.
                            <div class="single-article-img"><img src="images/hcb4.jpg" alt="Hystrix Circuit Breaker" /></div>
                        </li>
                    </ul>
                </li>
            </ul>
            <p><strong>NOTE:</strong> You have to create one more spring boot application with the Profiles called “profiles: noun” in your bootstrap yaml file and then you have to provide the implementation for the getPerson() method with @GetMapping annotation. In this method, you can implement some logic. So, this method will</p>
            <ul class="listing">
                <li>
                    1.  Now, in your service Layer, create a class called PersonService. I am doing here a setter injection of the PersonService. Depending on how you Build your PersonClient class, you may need to refactor the “getAllPersons()” method slightly.
                    <div class="single-article-img"><img src="images/hcb5.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    2.  Now we have to write a controller class called “PersonController.java” to call the method that we have declared in the service class that will internally call the other service method called(getPerson()):Example:
                    <div class="single-article-img"><img src="images/hcb6.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    3. Now you can run your application and test if it works perfectly. Hit the URL: <a href="javascript:;">http://localhost:8020/personInfo</a>. The application will give you the personal details that you would have written in other services. So, here, it is using a declarative Feign client to make the Person call.
                </li>
            </ul>
            <h4>Spring Hystrix Overview:</h4>
            <ul class="listing">
                <li>I am going to explain to you about the Spring Hystrix and the circuit breaker pattern. Through this blog, you will learn how software circuit breakers protect against cascade failures and how to use spring cloud Netflix Hystrix annotation <a href="https://www.nexsoftsys.com/technologies/java-web-development.html" target="_blank">within our Java software development</a> to implement circuit breakers. Also, I am going to illustrate how to establish simple monitoring of circuit breaker using Hystrix dashboard and turbine.</li>
            </ul>
            <p>Let’s explore a scenario known as “Cascade failure”:</p>
            <ul class="listing">
                <li>Whenever we have a large number of interacting services, there is always a possibility that one of them could be in a failed state for any reason. If we have 500 or more micro services,   then we can depend on at least one to be in a failed state. The issue is the effect that the individual failures have on the other services.  So, having a large number of services as dependencies can lead to “cascading failures”.</li>
                <li>Microservices architecture is very vulnerable to this type of cascade failure. We have to take actions to isolate failures to prevent cascade failures from resulting in significant outages for large percentage of time. And this leads us to the “Circuit Breaker” Pattern. The main point of the Circuit breaker is to detect the failure condition and to isolate the it. So, thereby it prevents cascade failures.</li>
            </ul>
            <h4>Hystrix -The Software Circuit Breaker Implementation:</h4>
            <ul class="listing">
                <li>Hystrix is part of the Netflix open source software set of libraries. Spring Cloud provides easy to use a wrapper to take advantages of Hystrix libraries. Just like a physical circuit breaker, Hystrix detects failure conditions. Let’s say we are calling service and we start to get repeated failures in a period. Then Hystrix will respond by opening the circuit. Here “opening” means Hystrix is not going to allow further calls to take place. The default behavior in Hystrix is 20 failures over any 5-second window of time.</li>
                <li>Also using Hystrix, we can define what we want to do when the primary service call is not available. Fallbacks can be chained. We can have a primary action and if that does not work, then we can go to a fallback action and it that also does not work then we can go to the 3rd fallback. Hystrix is designed to reclose itself after an interval to see the service is available. By default, Hystrix will reclose the circuit after 5 seconds.</li>
            </ul>
            <p><strong>Hystrix Setup:</strong></p>
            <ul class="listing">
                <li>
                    First, we have to add the dependency for the spring cloud Hystrix. There is a starter for this. 
                    <div class="single-article-img"><img src="images/hcb7.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>Then, in one of our Configuration class, we have to enable Hystrix by annotating the class with “@EnableHystrix” annotation. Now for actual Hystrix use, we have to use the “@HystrixCommand” annotation to wrap methods in a circuit breaker. Please look at the below example:</li>
                <li>
                    Wrap methods in a Circuit breaker using “@HystrixCommand. 
<xmp>
@Component
public class StoreIntegration {
    // Based on the recent failures Hystrix will call one of these below two methods
    @HystrixCommand(fallbackMethod = ”defaultStores”)
    public Object getStores(Map < String, Object > params) {
        // do stuff that might fail
    }
    public Object defaultStores(Map < String, Object > params) {
        return /* something useful */;
    }
}
</xmp>                    
                </li>
                <li>You can see the above code snippet image where I am using a Spring bean marked with “@Component” annotation. Any stereotype annotation can be used here. Then I have defined a “getStores()” method. Imagine the logic here that I have to make an external call from this method, and it is subject to failure. So, we have to mark this getStores() method with  “@HystrixCommand”  annotation. In this case, a fallback method is identified. The Fallback method needs to have a matching signature in terms of parameters and return types.</li>
                <li>So, when the above code runs then depending upon the state of the circuit breaker, one of these two methods will get executed. If we are in a failed state, the fallback method will run. The “defaultStores()” method itself could be instantiated with Hystrix Command. Then it could indicate a tertiary fallback and there is no limit to the number of levels of fallbacks. But most real-time scenarios can be handled with one or two levels.</li>
            </ul>
            <p><strong>Failure/Recovery behavior can be easily customizable with Hystrix</strong></p>
            <p>Hystrix allows us is a good deal of fine-tuning regarding failure detection and recovery behavior. In the below example, I have adjusted the error threshold.</p>
            <p>Customizable Recovery behavior:</p>
<xmp>
// Based on the recent failures Hystrix will call one of these below two methods
// Here, after 1 sec, it will try closing breaker 
// when 20% failure rate in 10sec period then open the breaker.

@HystrixCommand(fallbackMethod = ”defaultStores”, commandProperties = {
    @ HystrixProperty(name = ”circuitBreaker.errorThresholdPercentage”, value = ”20”),
        @HystrixProperty(name = ”circuitBreaker.sleepWindowInMilliseconds”, value = ”1000”)
})
public Object getStores(Map < String, Object > params) {
    // …
}

}
</xmp>

            <p>In the above example, if Hystrix detects a 20% failure rate over a 10-sec moving window of time, it will trip the breaker. In our example, I have determined that 1sec reset time. Hystrix commands give us nice options for how we want the target logic to be invoked. The default behavior is “Synchronous Execution”. We execute the command and when it is done then we get the control back.</p>
            <p>We also have the option of “Asynchronous Execution” where we can fire the command in a separate thread. This is the same that we can do with the spring’s “@Async” annotation except that we are adding the Hystrix circuit breaker features to it.</p>
            <p>Also, Hystrix provides a “Reactive” model which is also asynchronous. It is better because here we do not need to query a future object to see if it is done unlike in the Asynchronous case. We can have Observable that will be executed and as soon as the work is done the responding logic will be fired and therefore all we have to do is listen to the event.</p>
            <p><strong>Asynchronous Command Execution Example:</strong></p>
            <p>I am giving you an example of Asynchronous command execution via Hystrix. See the below code snippet:</p>
<xmp>
@HystrixCommand(…)
public Future < Store > getStores(Map < String, Object > param) {
        Return new AsyncResult < Store > () {
            @Override
            public Store invoke() { //do stuff that might fail}
            };
        }
</xmp>
            <p>The main difference is the Return type. Any return type based on a Java future tells Hystrix to invoke the method in a separate thread. The caller of the method gets the future immediately and has the option of checking the future to see if it is done.</p>
            <p><strong>Reactive Command Execution Example:</strong></p>
            <p>I am giving you an example of Reactive Command Execution via Hystrix. See the below code snippet:</p>
<xmp>
@HystrixCommand(…)
public Observable < Store > getStores(Map < String, Object > param) {
        Return new ObservableResult < Store > () {
            @Override
            public Store invoke() { //do stuff that might fail}
            };
        }
</xmp>
            <p>Notice that in the above code, the return value is kind of observable. This instructs hystrix to use the reactive model for invocation. The caller of this code will get the observable and can subscribe to it as a listener. The listening code will be invoked automatically as soon as the call is complete. The method needs to return an observable result. This “Observable” is from JAX-RS.  There is many useful properties available that you can set to fine-tune the behavior</p>
            <p>Example:</p>
            <ul class="listing">
                <li>
                    <p><strong>execution.isolation.thread.timeOutInMilliseconds:</strong> How long should we wait for success.</p>
                </li>
                <li>
                    <p><strong>circuitBreaker.requestVolumeThreshold:</strong> Number of requests in rolling time window(10 sec) that activate the circuit breaker</p>
                </li>
                <li>
                    <p><strong>circuitBreaker.errorThresholdPercentage:</strong> Percentage of failed requests that will trip the breaker (default = 50%)</p>
                </li>
                <li>
                    <p><strong>metrics.rollingStats.timeInMilliseconds:</strong> Size of the rolling time window(default =10sec)</p>
                </li>
            </ul>
            <p><strong>Resetting the Circuit Breaker:</strong></p>
            <p>The Hystrix circuit breaker is designed to reset itself. The main thing is to control is how long we would like the circuit breaker to stay open before Hystrix tries to close it again. This is controlled by the “circuitBreaker.sleepWindowinMilliseconds” properties. We can also force the circuit breaker open using the “circuitBreaker.forceClosed” property. This is for manual purposes.</p>
            <p><strong>Monitoring:</strong></p>
            <p>We can monitor everything with Hystrix Dashboard and Turbine. Hystrix provides a built-in dashboard to check the status of the circuit breakers.  For a large number of microservices, Hystrix dashboard is not really practical.  So, Turbine is the solution for this. It aggregates the streams of all of the other Hystrix enabled services.</p>
            <h4>DEMO: Implementing Hystrix Circuit Breaker (with Feign client and Eureka) In your Project:</h4>
            <ul class="listing">
                <li>1.  First, you start your config-server and eureka-server. To learn how to implement these, then visit our Eureka Blog.</li>
                <li>2.  Create a new Spring Boot web application and named it to “demo-client”. And in the Pom file, I have added the same dependency management for identifying the spring cloud parent Pom. And In the dependencies section of Pom, added the dependency for a group "org.springframework.cloud" an artifact "spring-cloud-starter-netflix-eureka-client”.</li>
                <li>3.  Then create the main application class called “MyClientApplication.java”. Then used the annotation “@EnableDiscoveryClient” to this class. Example:
                    <div class="single-article-img"><img src="images/hcb8.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
            </ul>
            <p>Then create a Rest controller class called “NameController.java”. An added string array of names with @Value annotation. So that these names value can be read from our application.yml file. And in the controller class, I have added a controller method called “getNames()” with Get mapping. This method returns a string value from the “names” array with a dynamically chosen index. Example:</p>
            <div class="single-article-img"><img src="images/hcb9.jpg" alt="Hystrix Circuit Breaker" /></div>
            <ul class="listing">
                <li>
                    <p>1.   In your application.yml file in classpath root folder i.e. (src/main/resources), add “person”  profile and also below details:</p>
                    <div class="single-article-img"><img src="images/hcb10.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    <p>2.   Then in your bootstrap.yml file, give your application name as below:   </p>
                    <div class="single-article-img"><img src="images/hcb11.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    <p>3.   Now, you have to create again 3 spring boot applications similarly. So, please follow the same steps. It is easy for you can copy the <a href="https://www.nexsoftsys.com/services/software-it-outsourcing-services.html" target="_blank">entire software projects outsourcing</a> that I create and then only change the below fields </p>
                    <ul class="listing">
                        <li>Give application names for respective projects as: “demo-client2”, “demo-client3”, “demo-client4”</li>
                        <li>Change application name in each of your application’s bootstrap.yml file.</li>
                        <li>You have to keep different profile for different applications. Please refer the below image. Add these profiles in respective projects:</li>
                    </ul>
                    <div class="single-article-img"><img src="images/hcb12.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    <p>4.   Start all your previous application(demo-client, demo-client2, demo-client3, demo-client4). Now, create a new Spring boot web application called “demo-client-final”.  In your Pom file, add the below Hystrix dependencies. Here, I have added also the Hystrix Dashboard to our demo-client-final application.</p>
                    <div class="single-article-img"><img src="images/hcb13.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    <p>5.   Create your application configuration class and add @EnableHystrixDashboard annotation to your Application configuration class</p>
                    <div class="single-article-img"><img src="images/hcb14.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    <p>6.   Now, create all 4 interfaces with @FeignClient annotation in your dao layer like below:</p>
                    <div class="single-article-img"><img src="images/hcb15.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    <p>7.   There are the PersonService interface and PersonServiceImpl implementation class that wraps calls to the Feign clients. I am using Hystrix here in PersonServiceImpl. Suppose here we do not want to have an Age in our details. So, if the Age service is failing, modify the getAge() service to run within a Hystrix Command. Establish a fallback method that will return an empty Age value. Example:</p>
                    <div class="single-article-img"><img src="images/hcb16.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    <p>8.   Now, we have to create a Profile Service impl. A class where we will call all methods of the PersonService interface so that we can get a complete profile of a person.</p>
                    <div class="single-article-img"><img src="images/hcb17.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    <p>9.   Now, create a controller class to call our ProfileService interface’s getPersonDetails() method so that we can get the age, state, name and sex of each person.</p>
                    <p><strong>Example:</strong></p>
                    <div class="single-article-img"><img src="images/hcb18.jpg" alt="Hystrix Circuit Breaker" /></div>
                </li>
                <li>
                    <p>10.  Now, launch your demo-client-final application and test it to make sure it works by accessing the URL (<a href="javascript:;">http://localhost:8020/profiles</a>) in your browser. The application should work but the “Age” call is now going through a Hystrix circuit breaker.</p>
                </li>
                <li>
                    <p>11.  Now, stop the Age service. Refresh the URL (<a href="javascript:;">http://localhost:8020/profiles</a>). The profile should appear without an age. Restart the Age service. Once the Eureka registration is complete and the circuit breaker re-closes, the demo-client-final application will once again display age in the profile details.</p>
                </li>
            </ul>
            <h4>Conclusion:</h4>
            <p>So, finally, at the end of our discussion, you learned how Feign provides a very easy way to call RESTful Services. Feign integrates with Ribbon and Eureka automatically. Also, you learned how Hystrix circuit breakers protect against cascade failure and how easy it is to add a Hystrix circuit breaker to our application.</p>
            <h3>Reference:</h3>
            <ul class="listing">
                <li><a href="https://cloud.spring.io/spring-cloud-netflix/multi/multi_spring-cloud-feign.html" target="_blank">https://cloud.spring.io/spring-cloud-netflix/multi/multi_spring-cloud-feign.html</a></li>
                <li><a href="https://cloud.spring.io/spring-cloud-netflix/multi/multi__circuit_breaker_hystrix_clients.html" target="_blank">https://cloud.spring.io/spring-cloud-netflix/multi/multi__circuit_breaker_hystrix_clients.html</a></li>
            </ul>
            <!-- # -->
        </div>
        
        <div class="Clear">&nbsp;</div>

    </div>
    </div>
    <!--Page-Size-->
    

<div id="nss-note"><img src="../images/nss.jpg" alt="NSS Note" /></div>

    <div class="clients-section margin_top30">
        <div class="section-header ourclients">
            <h4>Some of our clients</h4>
        </div>
        <div class="container">
            <div class="clients-block owl-carousel owl-theme">
                <div class="item client1"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client2"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client3"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client4"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client5"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client8"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client9"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client10"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client11"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client15"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client16"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client17"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client12"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client13"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client14"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client6"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client7"><img src="../images/spacer.gif" alt="client" /></div>
            </div>
        </div>
    </div>
    <div class="teams-section">
        <div class="container">
            <div class="teams-title">
                <img data-src="../images/team-title.svg" class="lazyload" alt="team" />
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer-main">
        <div class="container">
            <div class="row">
                <div class="footer-box">
                    <h3>Services</h3>
                    <div class="footer-innerbox-block">
                        <div class="footer-innerbox">
                            <ul class="listing">
                                <li><a href="../services/application-development.html">Application Development</a></li>
                                <li><a href="#">Digital Transformation</a></li>
                                <li><a href="../services/software-consulting-services.html">Software Consulting Services</a></li>
                                <li><a href="../services/software-it-outsourcing-services.html">Software IT Outsourcing</a></li>
                                <li><a href="../services/offshore-development-center.html">Offshore Development</a></li>
                                <li><a href="../services/big-data-services.html">Big Data</a></li>
                                <li><a href="../services/real-time-data-analytics-services.html">Real Time Analytics</a></li>
                                <li><a href="#">Block Chain</a></li>
                                <li><a href="../services/devops-consulting.html">DevOps</a></li>
                            </ul>
                        </div>
                        <div class="footer-innerbox">
                            <ul class="listing">
                                <li><a href="../services/offshore-qa-testing-services.html">QA and Testing Services</a></li>
                                <li><a href="../services/amazon-cloud-services.html">Amazon Cloud Services</a></li>
                                <li><a href="../services/cloud-application-development.html">Cloud Application</a></li>
                                <li><a href="../services/mobility-solutions.html">Enterprise Mobility</a></li>
                                <li><a href="#">Business Intelligence</a></li>
                                <li><a href="../services/data-warehousing-solutions.html">Data ware Housing</a></li>
                                <li><a href="#">Data Integration</a></li>
                                <li><a href="../services/ETL-data-integration-services.html">ETL</a></li>
                                <li><a href="#">Dashboards</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="footer-box">
                    <h3>Technologies</h3>
                    <div class="footer-innerbox w35">
                        <ul class="listing">
                            <li><a href="../technologies/java-application-development.html">Java</a></li>
                            <li><a href="../technologies/python-development-services.html">Python</a></li>
                            <li><a href="../technologies/scala-development.html">Scala</a></li>
                            <li><a href="../technologies/magento-ecommerce.html">Magento</a></li>
                            <li><a href="../technologies/android-app-development.html">Android</a></li>
                            <li><a href="../technologies/ios-application-development.html">iOS</a></li>
                            <li><a href="../technologies/pentaho-BI-Services.html">Pentaho BI</a></li>
                        </ul>
                    </div>
                    <div class="footer-innerbox w65">
                        <ul class="listing">
                            <li class="list-title"><strong>Microsoft</strong></li>
                            <li><a href="../technologies/net-application-development.html">.Net Development</a></li>
                            <li><a href="../technologies/microsoft-dynamics-365.html">Dynamics 365</a></li>
                            <li><a href="../technologies/dynamics-365-business-central-solutions-development.html">Dynamics 365 Business Central</a></li>
                            <li><a href="../technologies/dynamics365-finance-and-operations.html">Dynamics 365 Finance &amp; Operations</a></li>
                            <li><a href="../technologies/microsoft-dynamics-crm-consulting.html">Dynamics CRM</a></li>
                            <li><a href="#">Power BI</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-box footer_sm">
                    <div class="footer-box-business">
                        <h3>Business with us</h3>
                        <ul class="listing">
                            <li><a href="../company.html">Company</a></li>
                            <li><a href="../contact.html">Contact Us</a></li>
                            <li><a href="../careers.html">Careers</a></li>
                            <li><a href="/articles/">Blog</a></li>
                            <li><a href="mailto:info@nexsoftsys.com">Mail Us</a></li>
                        </ul>
                        <div class="footer-socialbox">
                            <h3>Follow NEX</h3>
                            <div class="ft-social">
                                <a href="https://www.facebook.com/NexSoftSys/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                                <a href="https://twitter.com/nexsoftsys" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                                <a href="https://www.linkedin.com/company/nexsoftware/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
                                <a href="https://www.youtube.com/c/Nexsoftsys" target="_blank"><i class="fa fa-youtube-play" aria-hidden="true"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            <div class="ast"><p>An Aegis Group Company</p><span></span></div>
            </div>
        </div>
        <div class="copyright_text">
            <div class="copyright_text">
                <div class="container footer-rating">
                    <p>Copyright &copy; <span id="year"></span> NEX Software All rights reserved</p>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer /- -->

    <script defer src="../js/jquery-1.12.4.min.js"></script>
    <script defer src="../js/lib.js"></script>
    <script defer src="js/functions.js"></script>

</body>

</html>