<!DOCTYPE html>
<html lang="en-US">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Big Data Tutorial : Unit Testing Spark Jobs for Faster Development</title>
<meta name="description" content="Big data Solution Tutorial on Unit Testing Spark Jobs for easy testing and debugging that improves developers efficiency. However, the Big data spark coders seem to be oblivious to this simple fact." />
<meta name="keywords" content="Big Data Solution" />
<link rel="canonical" href="https://www.nexsoftsys.com/articles/big-data-tutorial-unit-testing-spark-faster-development.html" />

<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Big Data Tutorial : Unit Testing Spark Jobs for Faster Development" />
<meta property="og:description" content="Big data Solution Tutorial on Unit Testing Spark Jobs for easy testing and debugging that improves developers efficiency. However, the Big data spark coders seem to be oblivious to this simple fact." />
<meta property="og:url" content="https://www.nexsoftsys.com/articles/big-data-tutorial-unit-testing-spark-faster-development.html" />
<meta property="og:site_name" content="NEX Softsys" />
<meta property="article:publisher" content="https://www.facebook.com/NexSoftSys/" />
<meta property="article:section" content="Trending" />
<meta property="og:image" content="https://www.nexsoftsys.com/articles/images/testing-spark-main.jpg" />
<meta property="og:image:secure_url" content="https://www.nexsoftsys.com/articles/images/testing-spark-main.jpg" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Big data Solution Tutorial on Unit Testing Spark Jobs for easy testing and debugging that improves developers efficiency. However, the Big data spark coders seem to be oblivious to this simple fact." />
<meta name="twitter:title" content="Big Data Tutorial : Unit Testing Spark Jobs for Faster Development" />
<meta name="twitter:site" content="@nexsoftsys" />
<meta name="twitter:image" content="https://www.nexsoftsys.com/articles/images/testing-spark-main.jpg" />
<meta name="twitter:creator" content="@nexsoftsys" />

<link type="image/x-icon" href="../images/favicon.ico" rel="shortcut icon" />
<link rel="apple-touch-icon" sizes="57x57" href="../images/apple-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="../images/apple-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="../images/apple-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="../images/apple-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="../images/apple-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="../images/apple-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="../images/apple-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="../images/apple-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="../images/apple-icon-180x180.png" />
<link rel="icon" type="image/png" sizes="192x192" href="../images/android-icon-192x192.png" />
<link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="../images/favicon-96x96.png" />
<link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16.png" />
<link rel="manifest" href="../images/manifest.json" />
<meta name="msapplication-TileColor" content="#ffffff" />
<meta name="msapplication-TileImage" content="images/ms-icon-144x144.png" />
<meta name="theme-color" content="#ffffff" />

	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-64517863-1', 'auto');
		ga('send', 'pageview');
	</script><!-- Google Analytics /- -->
	
	<!-- Library -->
	<link rel="stylesheet" type="text/css" href="../css/lib.css">
	
	<!-- Custom - Common CSS -->
	<link rel="stylesheet" type="text/css" href="../css/style.css">
	<link rel="stylesheet" type="text/css" href="../css/navigation.css">
	<link rel="stylesheet" type="text/css" href="../style.css"/>
<noscript>
<div class="ndiv">
<div class="ntext">
<b>JavaScript Required</b>
<p>We're sorry, but we doesn't work properly without JavaScript enabled.</p>
</div>
</div>
</noscript>
</head>

<body>
    <!-- Header Section -->
    <div id="return-to-top"><i class="fa fa-angle-up"></i></div>

    <header class="header_s">
        <!-- ===== Popup Box ===== -->
        <section class="top-box">
            <div class="container">
                <div class="row">
                    <div class="col-12 same-line">
                        <div class="contain-box">
                            <p>Looking for an Expert Development Team? Take two weeks Trial! <a href="javascript:;" id="myBtn">Try Now</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="modal" id="myModal">
            <div class="modal-content">
                <div class="modal-header">
                    <span class="close">&times;</span>
                    <strong>Free 2 Week Trial</strong>
                </div>
                <div class="modal-form">
                    <form>
                        <div class="form-group">
                            <label>Your Name *</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Name" placeholder="Your Name" />
                        </div>
                        <div class="form-group">
                            <label>Your Email *</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Email" placeholder="Your Email" />
                        </div>
                        <div class="form-group">
                            <label>Your Mobile *</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Phone" placeholder="Your Mobile" />
                        </div>
                        <div class="form-group">
                            <label>Subject</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Subject" placeholder="Subject" />
                            <input type="hidden" id="txt2Page" value="" />
                        </div>
                        <div class="form-group">
                            <label>Your Message</label>
                            <textarea class="form-control" cols="5" rows="5" placeholder="Your Message" id="txt2Message" name="message"></textarea>
                        </div>
                        <div class="form-group">
                            

<img id="imgCaptchaRFP" alt="captcha" src="" class="captcha-style" />
                            <input class="form-control captcha-txt" type="text" placeholder="Captcha" id="txt2Captcha" name="txtCaptcha" />
                        </div>
                    </form>
                </div>
                <div class="modal-footer text-center">
                    <button type="button" id="btn2WeekSubmit" value="Send" name="Submit">Send</button>
                    <p><span id="lbl2WeekInfo" class="lblblack"></span></p>
                </div>
            </div>
        </section>
        <!-- # -->
        <div class="container-fluid">
            <div class="menu-block">
                <div class="mobile-sticky-footer">
                    <a target="_blank" class="skype" href="skype:aegissoftware?call"><i class="fa fa-fw" aria-hidden="true" title="Skype"></i></a>
                    <a target="_blank" class="whatsapp" href="https://api.whatsapp.com/send?phone=919824127020&text=Hi&sbquo;&nbsp;I&nbsp;am&nbsp;Connect&nbsp;through&nbsp;your&nbsp;website"><i class="fa fa-fw" aria-hidden="true" title="Whatsapp"></i></a>
                    <a target="_blank" class="inquiry" href="tel:+16469710799"><i class="fa fa-fw" aria-hidden="true" title="Phone"></i></a>
                    <a target="_blank" class="case-studies" href="mailto:info@nexsoftsys.com"><i class="fa fa-fw" aria-hidden="true" title="Email"></i></a>
                    <a href="../rfp.html" class="client-speaks"><i class="fa fa-fw" aria-hidden="true" title="RFP"></i></a>
                </div>	
                <div class="container">
                    <nav class="menu-navigation">
                        <div class="logo-block">
                            <a class="navbar-brand" href="/">
                                <img src="../images/logo.png" alt="logo" />
                            </a>
                        </div>
                        <a class="menuswitch" href="#">
                            <span class="menuline bar1"></span>
                            <span class="menuline bar2"></span>
                            <span class="menuline bar3"></span>
                        </a>
                        <div class="menu-collapse">
                            <ul class="navigation-menu">
                                <li><a href="/">Home</a></li>
                                <li><a href="../company.html">About Us</a></li>
                                <li class="dropdown">
                                    <i class="ddl-switch"></i>
                                    <a href="#">Services</a>
                                    <ul class="dropdown-menu">
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/application-development.html">Application Development</a></li>
                                            <li><a href="#">Digital Transformation</a></li>
                                            <li><a href="../services/software-consulting-services.html">Software Consulting Services</a></li>
                                            <li><a href="../services/software-it-outsourcing-services.html">Software IT Outsourcing</a></li>
                                            <li><a href="../services/offshore-development-center.html">Offshore Development</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/big-data-services.html">Big Data</a></li>
                                            <li><a href="../services/real-time-data-analytics-services.html">Real Time Analytics</a></li>
                                            <li><a href="#">Block Chain</a></li>
                                            <li><a href="../services/devops-consulting.html">DevOps</a></li>
                                            <li><a href="../services/offshore-qa-testing-services.html">QA and Testing Services</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/amazon-cloud-services.html">Amazon Cloud Services</a></li>
                                            <li><a href="../services/cloud-application-development.html">Cloud Application</a></li>
                                            <li><a href="../services/mobility-solutions.html">Enterprise Mobility</a></li>
                                            <li><a href="#">Business Intelligence</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/data-warehousing-solutions.html">Data ware Housing</a></li>
                                            <li><a href="#">Data Integration</a></li>
                                            <li><a href="../services/ETL-data-integration-services.html">ETL</a></li>
                                            <li><a href="#">Dashboards</a></li>
                                        </div>
                                    </ul>
                                </li>
                                <li class="dropdown">
                                    <i class="ddl-switch"></i>
                                    <a href="#">Technologies</a>
                                    <ul class="dropdown-menu two_col">
                                        <div class="dropdown-menubox">
                                            <li><a href="../technologies/java-application-development.html">Java</a></li>
                                            <li><a href="../technologies/python-development-services.html">Python</a></li>
                                            <li><a href="../technologies/scala-development.html">Scala</a></li>
                                            <li><a href="../technologies/magento-ecommerce.html">Magento</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../technologies/android-app-development.html">Android</a></li>
                                            <li><a href="../technologies/ios-application-development.html">iOS</a></li>
                                            <li><a href="../technologies/pentaho-BI-Services.html">Pentaho BI</a></li>
                                        </div>
                                        <div class="dropdown-menubox microsoft_nested">
                                            <li class="full_width"><strong>Microsoft</strong></li>
                                            <li><a href="../technologies/net-application-development.html">.Net Development</a></li>
                                            <li><a href="../technologies/microsoft-dynamics-365.html">Dynamics 365</a></li>
                                            <li><a href="../technologies/dynamics-365-business-central-solutions-development.html">Dynamics 365 Business Central</a></li>
                                            <li><a href="../technologies/dynamics365-finance-and-operations.html">Dynamics 365 Finance &amp; Operations</a></li>
                                            <li><a href="../technologies/microsoft-dynamics-crm-consulting.html">Dynamics CRM</a></li>
                                            <li><a href="#">Power BI</a></li>
                                        </div>
                                    </ul>
                                </li>
                                <li><a href="/articles/">Blog</a></li>
                                <li><a href="../contact.html" class="menu-box">Contact Us</a></li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header><!-- Header Section /- -->

    <div class="b-notification-bar">
            <!-- Social Links -->
            <ul class="btnlist">
                <li class="item skype">
                    <a href="skype:aegissoftware?call">
                        <div class="sticky-box">
                            <p><i class="fa fa-skype"></i></p>
                            <p>Skype</p>
                        </div>
                    </a>
                </li>
            </ul>
            <!-- # Social Links -->

            <!-- Inquiry Form -->
            <ul class="btnlist">
                <li class="item inquiry">
                    <div id="inquiry_form" class="btn sticky-box">
                        <p><i class="fa fa-envelope" aria-hidden="true"></i></p>
                        <p>Quick Inquiry</p>
                    </div>
                    <div class="info-box inq">
                        <img src="images/close-icon.png" class="closeInquiry" alt="close" />
                        <strong class="title">Fill the details and We’ll get back to you soon</strong>
                        <form>
                            <div class="inquiry-box">
                                <div class="form-group fullwidth">
                                    <textarea class="form-control" id="txtcomments" placeholder="Tell us your requirements"></textarea>
                                </div>
                                <div class="form-group-block">
                                    <div class="form-group">
                                        <input class="form-control" id="txtphone" placeholder="Phone" type="text" onkeydown="javascript:backspacerDOWN(this, event);" onkeyup="javascript:backspacerUP(this, event);">
                                    </div>
                                    <div class="form-group">
                                        <input class="form-control" id="txtemail" placeholder="Email" type="email">
                                    </div>
                                    <div class="form-group">
                                        <input class="form-control" id="txtskype" placeholder="Skype" type="text">
                                    </div>
                                    <div class="form-group">
                                        <img id="imgCaptcha" alt="captcha" src="/Captcha.ashx" />
                                        <input class="form-control" type="text" placeholder="Captcha" id="txtCaptcha" name="txtCaptcha" />
                                    </div>
                                    <div class="form-group Clear">
                                        <button type="button" id="btnSubmit" value="Submit" name="Submit" class="btn-submit">Submit</button>
                                    </div>
                                    <div class="form-group Clear">
                                        <span id="lblInfo"> </span>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </li>
            </ul><!-- Inquiry Form /- -->
            <!--Btns-->
            <ul class="btnlist">
                <li class="item case-studies">
                    <div class="btn sticky-box" onClick="window.location.href='../casestudy/java/java-case-studies.html'">
                        <p><i class="fa fa-check-square-o" aria-hidden="true"></i></p>
                        <p>Case Studies</p>
                    </div>
                </li>
                <li class="item client-speaks">
                    <div class="btn sticky-box" onClick="window.location.href='../testimonials/java-testimonials.html'">
                        <p><i class="fa fa-smile-o" aria-hidden="true"></i></p>
                        <p>Client Speaks</p>
                    </div>
                </li>
            </ul><!--Btns-->
        </div>

    <div class="Inner-Banner">
        <div class="Page-Size">
            <h1>Big Data Tutorial : Unit Testing Spark Jobs for Faster Development</h1>
        </div>
    </div><!--Web-Banner-->

    <div class="Page-Size">
        <div class="Text Width-100">
            <div class="single-content-block">
                <div class="single-article-img">
                    <img src="images/testing-spark-main.jpg" alt="testing-spark" class="mr-2" />
                </div>
                <p>For any developer it is essential that he be able to easily test his code. The comfort of easy testing and debugging improves our efficiency. However, the Big data spark coders (at-least the ones I have worked with) seem to be oblivious to this simple fact. Following are some of the issues faced:</p>
                <ol class="article-listing listing">
                    <li>Depending on the problem you will need to shift between multiple external systems (S3, HDFS, Kafka, etc) to validate and debug.</li>
                    <li>We are consuming external resources for development purposes which increasing cost.</li>
                    <li>You may be using a copy of production data or worse production data itself. Someone making a mistake may lead to the production data getting corrupted.</li>
                    <li>There is possibility that the production copy may not cover all your use cases.</li>
                    <li>Depending on your data you may have to run the jobs for a long time on huge compute resources.</li>
                </ol>
                <div class="single-article-img align-center">
                    <img src="images/testing-spark-1.jpg" alt="testing-spark" />
                </div>
                <p>In conclusion the big data developer is wasting his time. Also increasing cost by using external system resources.</p>
                <p>This blog post is intended for big data developers  facing such issues. I will take you through a simple approach for <a href="../services/big-data-services.html">big data solutions</a> to speed-up the process of testing and debugging  spark jobs. </p>
                <h3>Scope</h3>
                <p>It is assumed that you are familiar with <a href="https://spark.apache.org/docs/2.3.1/quick-start.html" target="_blank">Spark</a>. Practically other than unit testing we may  also need to do integration tests and load tests. Such cases like connectivity  with external systems, scalability under load, etc. is not unit testing and are  beyond the scope of this blog. </p>
                <h3>The Problem</h3>
                <p>Following code should approximate the spark job that gets usually written.</p>
<xmp class="codding-box">
package com.udaykale.blog
import org.apache.spark.sql.SparkSession
class SampleJob {
    def main(args: Array[String]): Unit = {
        val jobName = "SampleJob"
        val filePath = "File path to production data"
        val topic = "sample-topic"
        val spark = SparkSession.builder()
            .master("local[2]")
            .appName(jobName)
            .getOrCreate()
        val inputDF = spark.read.parquet(filePath)
        import spark.implicits._
            // Usually we have more
        val outputDF = inputDF.where($ "id" === 1)
        outputDF.writeToKafka(topic)
    }
}
</xmp>
                <h3>If you want to test this code you will need</h3>
                <ul class="article-listing">
                    <li>To connect with file storage systems like S3/HDFS.</li>
                    <li>Connect with Kafka.</li>
                    <li>Proper test data in S3 to cover all use-cases.</li>
                    <li>Some place to run this job.</li>
                </ul>
                <h3>Unit testing</h3>
                <p>In unit testing we test units of programs like  methods, utilities, services, etc. Any external systems are <strong>mocked</strong> with a similar implementation.  For e.g. in the above snippet we can refactor the code to support reading from  S3 in production and reading from local file for unit test purposes.</p>
                <p>Note that and code related to Kafka initialisation was skipped. In writing unit test we don't need to deal with external systems anyway. We only need to concern ourselves with logic testing of the job. Later we will mock it.</p>
                <h3>The Solution</h3>
                <p>We will, to make the code testable, refactor the code as follows. </p>
<xmp class="codding-box">
package com.udaykale.blog
import org.apache.spark.sql. {
    DataFrame, SparkSession
}
object SampleJob {
    def main(args: Array[String]): Unit = {
        val jobName = "SampleJob"
        val filePath = "Some file Path"
        val topic = "sample-topic"
        val spark = SparkSession.builder()
            .master("local[2]")
            .appName(jobName)
            .getOrCreate()
        val outputDF = doSomeThing(spark, filePath)
        outputDF.writeToKafka(topic)
    }
    def doSomeThing(spark: SparkSession, filePath: String): DataFrame = {
        val inputDF = spark.read.parquet(filePath)
        import spark.implicits._
        return inputDF.where($ "id" === 1)
    }
}
</xmp>
                <p>For us now the doSomeThing method is the unit to test. The returned dataframe can be used for assertions in unit tests or writing to external systems like Kafka on production. We will now define a few environments, for convinence sake.</p>
<xmp class="codding-box">
package com.udaykale.blog
    object Environment {
        val LOCAL = 1;
        val DEV = 2;
        val PROD = 3;
    }
</xmp>
                <p>Next we will define a FileService trait. A ServiceFactory will return different implementations of this trait depending on the environment.</p>
<xmp class="codding-box">
package com.udaykale.blog import org.apache.spark.sql. {
    DataFrame,
    SparkSession
}

trait ServiceFactory[T] {
    protected def map(): Map[Int, T];
    def instance(env: Int): Option[T]=map().get(env);
}

trait FileService {
    def read(spark: SparkSession, filePath: String): DataFrame;
    def write(spark: SparkSession, filePath: String, df: DataFrame);
}

object FileServiceFactory extends ServiceFactory[FileService] {
    override protected def map(): Map[Int, FileService]=Map(Environment.DEV -> FileServiceCSV, Environment.LOCAL -> FileServiceDummy, Environment.PROD -> FileServiceS3Parquet)
}

object FileServiceS3Parquet extends FileService {
    override def read(spark: SparkSession, filePath: String): DataFrame= {
        spark.read.parquet(filePath)
    }
    override def write(spark: SparkSession, filePath: String, df: DataFrame): Unit= {
        df.write.parquet(filePath)
    }
}

object FileServiceCSV extends FileService {
    override def read(spark: SparkSession, filePath: String): DataFrame= {
        spark.read.csv(filePath)
    }
    override def write(spark: SparkSession, filePath: String, df: DataFrame): Unit= {
        df.write.csv(filePath)
    }
}

object FileServiceDummy extends FileService {
    override def read(spark: SparkSession, filePath: String): DataFrame= {
        import spark.implicits._ Seq( ("1", "Tom"), ("2", "Dick"), ("3", "Harry")).toDF("id", "name")
    }
    override def write(spark: SparkSession, filePath: String, df: DataFrame): Unit= {
        df.show(false)
    }
}
</xmp>
                <p>I have defined the FileServiceDummy for explanation in this bog. Ideally you will use the FileServiceCSV with yours test data residing in your local machine in CSV format.</p>
                <p>We will use this in our job as follows:</p>
<xmp class="codding-box">
package com.udaykale.blog
import org.apache.spark.sql. {
    DataFrame, SparkSession
}
object SampleJob {
    def main(args: Array[String]): Unit = {
        val jobName = "SampleJob"
        val filePath = "Some file Path"
        val topic = "sample-topic"
        val env = Environment.PROD
        val spark = SparkSession.builder()
            .master("local[2]")
            .appName(jobName)
            .getOrCreate()
        val fileService = FileServiceFactory.instance(env)
        if (fileService.isEmpty) throw new NullPointerException("Instance of File Service not found")
        val outputDF = doSomeThing(spark, filePath, fileService.get)
        outputDF.writeToKafka(topic)
    }
    def doSomeThing(spark: SparkSession, filePath: String, fileService: FileService): DataFrame = {
        val inputDF = fileService.read(spark, filePath)
        import spark.implicits._
        return inputDF.where($ "id" === 1)
    }
}
</xmp>
                <p>As you can see we have mocked the file reading code which can be selected based on the run time. By default it will try to read the parquet file since we have defined the environment as production. </p>
                <p>For unit testing we will use the scala test library. To use this add </p>
<xmp class="codding-box">
libraryDependencies += "org.scalatest" % "scalatest_2.11" % "3.0.5"
</xmp>
                <p>to the project's .sbt file.</p>
                <p>Following is the unit test for our doSomeThing method.</p>
<xmp class="codding-box">
package com.udaykale.blog
import com.udaykale.blog.SampleJob2.doSomeThing
import org.apache.spark.sql. {
    DataFrame, SparkSession
}
import org.scalatest.FlatSpec
class SampleJobTest extends FlatSpec {
    "doSomeThing"
    should "Do Some Thing" in {
        val jobName = "SampleJob"
        val filePath = "Some file Path"
        val topic = "sample-topic"
        val env = Environment.LOCAL
        val spark = SparkSession.builder()
            .master("local[2]")
            .appName(jobName)
            .getOrCreate()
        val fileService = FileServiceFactory.instance(env)
        if (fileService.isEmpty) throw new NullPointerException("Instance of File Service not found")
        val outputDF = doSomeThing(spark, filePath, fileService.get)
        import spark.implicits._
        val expectedDF = Seq(
            ("1", "Tom")
        ).toDF("id", "name")
        assertDF(spark, outputDF, expectedDF)
    }
    def assertDF(spark: SparkSession, actualDF: DataFrame, expectedDF: DataFrame): Unit = {
        val actual = dfToStringSeqArray(spark, actualDF)
        val expected = dfToStringSeqArray(spark, expectedDF)
        if (actual.length != expected.length) assert(false)
        actual.zip(expected)
            .foreach(actualExpected => {
                if (actualExpected._1.length != actualExpected._2.length) assert(false)
                actualExpected._1.zip(actualExpected._2).foreach(zipValue => assert(zipValue._1 == zipValue._2))
            })
    }
    private def dfToStringSeqArray(spark: SparkSession, x: DataFrame): Array[Seq[String]] = {
        import spark.implicits._
        x.map {
                row => row.toSeq.map(value => value.asInstanceOf[String])
            }
            .collectAsList().toArray.asInstanceOf[Array[Seq[String]]]
    }
}
</xmp>
                <p>The test class extends the FlatSpec class. This class provides is a BDD style unit test functionality. Since, we have selected the environment as LOCAL the factory will then return the FileServiceDummy implementation. You can switch to DEV to fetch it from a local CSV file. The assertDF utility will test the actual and expected dataframes.</p>
                <p>To run this I use IntelliJ since it's convenient to debug. Right clicking on the test to run, should give you the necessary options.</p>
                <div class="single-article-img">
                    <img src="images/testing-spark-2.jpg" alt="testing-spark">
                </div>
                <h3>Advantages of this approach</h3>
                <ul class="article-listing">
                    <li>No connectivity with external systems required.</li>
                    <li>It's easy to validate and debug since the input output is confined within our own machine.</li>
                    <li>The data can be customised for testing and we can cover more use-cases because of it.</li>
                    <li>It's easy to switch between different environments.</li>
                    <li>We save cost by using our own machine only.</li>
                </ul>
                <h3>Read More:</h3>
                <ul class="listing">
                    <li><a href="artificial-intelligence-in-the-world-of-travel.html">Chatbots, The Smart Travel AI Concierges Will Help You Plan Your Next Trip!</a><strong></strong></li>
                    <li><a href="hbase-region-server-issues-tutorial.html">Tutorial : HBASE, Region Server and Related Issues – Eureka</a><strong></strong></li>
                    <li><a href="big-data-making-life-more-simplified.html">Big Data is Making Your Life More Simplified, Here&rsquo;s       How?</a><strong></strong></li>
                </ul>
            </div>
        </div>
    </div><!--Page-Size-->
    

<div id="nss-note"><img src="../images/nss.jpg" alt="NSS Note" /></div>

    <div class="clients-section margin_top30">
        <div class="section-header ourclients">
            <h4>Some of our clients</h4>
        </div>
        <div class="container">
            <div class="clients-block owl-carousel owl-theme">
                <div class="item client1"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client2"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client3"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client4"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client5"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client8"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client9"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client10"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client11"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client15"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client16"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client17"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client12"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client13"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client14"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client6"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client7"><img src="../images/spacer.gif" alt="client" /></div>
            </div>
        </div>
    </div>
    <div class="teams-section">
        <div class="container">
            <div class="teams-title">
                <img data-src="../images/team-title.svg" class="lazyload" alt="team" />
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer-main">
        <div class="container">
            <div class="row">
                <div class="footer-box">
                    <h3>Services</h3>
                    <div class="footer-innerbox-block">
                        <div class="footer-innerbox">
                            <ul class="listing">
                                <li><a href="../services/application-development.html">Application Development</a></li>
                                <li><a href="#">Digital Transformation</a></li>
                                <li><a href="../services/software-consulting-services.html">Software Consulting Services</a></li>
                                <li><a href="../services/software-it-outsourcing-services.html">Software IT Outsourcing</a></li>
                                <li><a href="../services/offshore-development-center.html">Offshore Development</a></li>
                                <li><a href="../services/big-data-services.html">Big Data</a></li>
                                <li><a href="../services/real-time-data-analytics-services.html">Real Time Analytics</a></li>
                                <li><a href="#">Block Chain</a></li>
                                <li><a href="../services/devops-consulting.html">DevOps</a></li>
                            </ul>
                        </div>
                        <div class="footer-innerbox">
                            <ul class="listing">
                                <li><a href="../services/offshore-qa-testing-services.html">QA and Testing Services</a></li>
                                <li><a href="../services/amazon-cloud-services.html">Amazon Cloud Services</a></li>
                                <li><a href="../services/cloud-application-development.html">Cloud Application</a></li>
                                <li><a href="../services/mobility-solutions.html">Enterprise Mobility</a></li>
                                <li><a href="#">Business Intelligence</a></li>
                                <li><a href="../services/data-warehousing-solutions.html">Data ware Housing</a></li>
                                <li><a href="#">Data Integration</a></li>
                                <li><a href="../services/ETL-data-integration-services.html">ETL</a></li>
                                <li><a href="#">Dashboards</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="footer-box">
                    <h3>Technologies</h3>
                    <div class="footer-innerbox w35">
                        <ul class="listing">
                            <li><a href="../technologies/java-application-development.html">Java</a></li>
                            <li><a href="../technologies/python-development-services.html">Python</a></li>
                            <li><a href="../technologies/scala-development.html">Scala</a></li>
                            <li><a href="../technologies/magento-ecommerce.html">Magento</a></li>
                            <li><a href="../technologies/android-app-development.html">Android</a></li>
                            <li><a href="../technologies/ios-application-development.html">iOS</a></li>
                            <li><a href="../technologies/pentaho-BI-Services.html">Pentaho BI</a></li>
                        </ul>
                    </div>
                    <div class="footer-innerbox w65">
                        <ul class="listing">
                            <li class="list-title"><strong>Microsoft</strong></li>
                            <li><a href="../technologies/net-application-development.html">.Net Development</a></li>
                            <li><a href="../technologies/microsoft-dynamics-365.html">Dynamics 365</a></li>
                            <li><a href="../technologies/dynamics-365-business-central-solutions-development.html">Dynamics 365 Business Central</a></li>
                            <li><a href="../technologies/dynamics365-finance-and-operations.html">Dynamics 365 Finance &amp; Operations</a></li>
                            <li><a href="../technologies/microsoft-dynamics-crm-consulting.html">Dynamics CRM</a></li>
                            <li><a href="#">Power BI</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-box footer_sm">
                    <div class="footer-box-business">
                        <h3>Business with us</h3>
                        <ul class="listing">
                            <li><a href="../company.html">Company</a></li>
                            <li><a href="../contact.html">Contact Us</a></li>
                            <li><a href="../careers.html">Careers</a></li>
                            <li><a href="/articles/">Blog</a></li>
                            <li><a href="mailto:info@nexsoftsys.com">Mail Us</a></li>
                        </ul>
                        <div class="footer-socialbox">
                            <h3>Follow NEX</h3>
                            <div class="ft-social">
                                <a href="https://www.facebook.com/NexSoftSys/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                                <a href="https://twitter.com/nexsoftsys" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                                <a href="https://www.linkedin.com/company/nexsoftware/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
                                <a href="https://www.youtube.com/c/Nexsoftsys" target="_blank"><i class="fa fa-youtube-play" aria-hidden="true"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            <div class="ast"><p>An Aegis Group Company</p><span></span></div>
            </div>
        </div>
        <div class="copyright_text">
            <div class="copyright_text">
                <div class="container footer-rating">
                    <p>Copyright &copy; <span id="year"></span> NEX Software All rights reserved</p>
                </div>
            </div>
        </div>
    </footer><!-- Footer /- -->

    <script defer src="../js/jquery-1.12.4.min.js"></script>
    <script defer src="../js/lib.js"></script>
    <script defer src="js/functions.js"></script>

    
</body>
</html>