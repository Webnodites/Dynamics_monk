<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Introduction to spring cloud bus example and ZUUL an API gateway?</title>
    <meta name="description" content="In this article, you'll learn about the implementation of Spring Cloud Bus with Examples and anatomy of API Gateway in Spring Cloud." />
    <meta name="keywords" content="Spring cloud bus, AMQP, RabbitMQ, Microservice, Spring boot" />
    <link rel="canonical" href="https://www.nexsoftsys.com/articles/implement-spring-cloud-bus-with-examples.html" />

    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Introduction to spring cloud bus example and ZUUL an API gateway?" />
    <meta property="og:description" content="In this article, you'll learn about the implementation of Spring Cloud Bus with Examples and anatomy of API Gateway in Spring Cloud." />
    <meta property="og:url" content="https://www.nexsoftsys.com/articles/implement-spring-cloud-bus-with-examples.html" />
    <meta property="og:site_name" content="NEX Softsys" />
    <meta property="article:publisher" content="https://www.facebook.com/NexSoftSys/" />
    <meta property="article:section" content="Trending" />
    <meta property="og:image" content="https://www.nexsoftsys.com/articles/images/Introduction-to-spring-cloud-bus.jpg" />
    <meta property="og:image:secure_url" content="https://www.nexsoftsys.com/articles/images/Introduction-to-spring-cloud-bus.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:description" content="In this article, you'll learn about the implementation of Spring Cloud Bus with Examples and anatomy of API Gateway in Spring Cloud." />
    <meta name="twitter:title" content="Introduction to spring cloud bus example and ZUUL an API gateway?" />
    <meta name="twitter:site" content="@nexsoftsys" />
    <meta name="twitter:image" content="https://www.nexsoftsys.com/articles/images/Introduction-to-spring-cloud-bus.jpg" />
    <meta name="twitter:creator" content="@nexsoftsys" />

    <link type="image/x-icon" href="../images/favicon.ico" rel="shortcut icon" />
    <link rel="apple-touch-icon" sizes="57x57" href="../images/apple-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="../images/apple-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="../images/apple-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="../images/apple-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="../images/apple-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="../images/apple-icon-152x152.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="../images/apple-icon-180x180.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="../images/android-icon-192x192.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="../images/favicon-96x96.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16.png" />
    <link rel="manifest" href="../images/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="images/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />

    <!-- Google Analytics -->
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-64517863-1', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- Google Analytics /- -->

    <!-- Library -->
    <link rel="stylesheet" type="text/css" href="../css/lib.css">

    <!-- Custom - Common CSS -->
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <link rel="stylesheet" type="text/css" href="../css/navigation.css">
    <link rel="stylesheet" type="text/css" href="../style.css" />

    <noscript>
        <div class="ndiv">
            <div class="ntext">
                <b>JavaScript Required</b>
                <p>We're sorry, but we doesn't work properly without JavaScript enabled.</p>
            </div>
        </div>
    </noscript>
</head>

<body>
    <!-- Header Section -->
    <div id="return-to-top"><i class="fa fa-angle-up"></i></div>

    <header class="header_s">
        <!-- ===== Popup Box ===== -->
        <section class="top-box">
            <div class="container">
                <div class="row">
                    <div class="col-12 same-line">
                        <div class="contain-box">
                            <p>Looking for an Expert Development Team? Take two weeks Trial! <a href="javascript:;" id="myBtn">Try Now</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="modal" id="myModal">
            <div class="modal-content">
                <div class="modal-header">
                    <span class="close">&times;</span>
                    <strong>Free 2 Week Trial</strong>
                </div>
                <div class="modal-form">
                    <form>
                        <div class="form-group">
                            <label>Your Name *</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Name" placeholder="Your Name" />
                        </div>
                        <div class="form-group">
                            <label>Your Email *</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Email" placeholder="Your Email" />
                        </div>
                        <div class="form-group">
                            <label>Your Mobile *</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Phone" placeholder="Your Mobile" />
                        </div>
                        <div class="form-group">
                            <label>Subject</label>
                            <input type="text" name="question-title" class="form-control" id="txt2Subject" placeholder="Subject" />
                            <input type="hidden" id="txt2Page" value="" />
                        </div>
                        <div class="form-group">
                            <label>Your Message</label>
                            <textarea class="form-control" cols="5" rows="5" placeholder="Your Message" id="txt2Message" name="message"></textarea>
                        </div>
                        <div class="form-group">
                            

<img id="imgCaptchaRFP" alt="captcha" src="" class="captcha-style" />
                            <input class="form-control captcha-txt" type="text" placeholder="Captcha" id="txt2Captcha" name="txtCaptcha" />
                        </div>
                    </form>
                </div>
                <div class="modal-footer text-center">
                    <button type="button" id="btn2WeekSubmit" value="Send" name="Submit">Send</button>
                    <p><span id="lbl2WeekInfo" class="lblblack"></span></p>
                </div>
            </div>
        </section>
        <!-- # -->
        <div class="container-fluid">
            <div class="menu-block">
                <div class="mobile-sticky-footer">
                    <a target="_blank" class="skype" href="skype:aegissoftware?call"><i class="fa fa-fw" aria-hidden="true" title="Skype"></i></a>
                    <a target="_blank" class="whatsapp" href="https://api.whatsapp.com/send?phone=919824127020&text=Hi&sbquo;&nbsp;I&nbsp;am&nbsp;Connect&nbsp;through&nbsp;your&nbsp;website"><i class="fa fa-fw" aria-hidden="true" title="Whatsapp"></i></a>
                    <a target="_blank" class="inquiry" href="tel:+16469710799"><i class="fa fa-fw" aria-hidden="true" title="Phone"></i></a>
                    <a target="_blank" class="case-studies" href="mailto:info@nexsoftsys.com"><i class="fa fa-fw" aria-hidden="true" title="Email"></i></a>
                    <a href="../rfp.html" class="client-speaks"><i class="fa fa-fw" aria-hidden="true" title="RFP"></i></a>
                </div>	
                <div class="container">
                    <nav class="menu-navigation">
                        <div class="logo-block">
                            <a class="navbar-brand" href="/">
                                <img src="../images/logo.png" alt="logo" />
                            </a>
                        </div>
                        <a class="menuswitch" href="#">
                            <span class="menuline bar1"></span>
                            <span class="menuline bar2"></span>
                            <span class="menuline bar3"></span>
                        </a>
                        <div class="menu-collapse">
                            <ul class="navigation-menu">
                                <li><a href="/">Home</a></li>
                                <li><a href="../company.html">About Us</a></li>
                                <li class="dropdown">
                                    <i class="ddl-switch"></i>
                                    <a href="#">Services</a>
                                    <ul class="dropdown-menu">
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/application-development.html">Application Development</a></li>
                                            <li><a href="#">Digital Transformation</a></li>
                                            <li><a href="../services/software-consulting-services.html">Software Consulting Services</a></li>
                                            <li><a href="../services/software-it-outsourcing-services.html">Software IT Outsourcing</a></li>
                                            <li><a href="../services/offshore-development-center.html">Offshore Development</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/big-data-services.html">Big Data</a></li>
                                            <li><a href="../services/real-time-data-analytics-services.html">Real Time Analytics</a></li>
                                            <li><a href="#">Block Chain</a></li>
                                            <li><a href="../services/devops-consulting.html">DevOps</a></li>
                                            <li><a href="../services/offshore-qa-testing-services.html">QA and Testing Services</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/amazon-cloud-services.html">Amazon Cloud Services</a></li>
                                            <li><a href="../services/cloud-application-development.html">Cloud Application</a></li>
                                            <li><a href="../services/mobility-solutions.html">Enterprise Mobility</a></li>
                                            <li><a href="#">Business Intelligence</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../services/data-warehousing-solutions.html">Data ware Housing</a></li>
                                            <li><a href="#">Data Integration</a></li>
                                            <li><a href="../services/ETL-data-integration-services.html">ETL</a></li>
                                            <li><a href="#">Dashboards</a></li>
                                        </div>
                                    </ul>
                                </li>
                                <li class="dropdown">
                                    <i class="ddl-switch"></i>
                                    <a href="#">Technologies</a>
                                    <ul class="dropdown-menu two_col">
                                        <div class="dropdown-menubox">
                                            <li><a href="../technologies/java-application-development.html">Java</a></li>
                                            <li><a href="../technologies/python-development-services.html">Python</a></li>
                                            <li><a href="../technologies/scala-development.html">Scala</a></li>
                                            <li><a href="../technologies/magento-ecommerce.html">Magento</a></li>
                                        </div>
                                        <div class="dropdown-menubox">
                                            <li><a href="../technologies/android-app-development.html">Android</a></li>
                                            <li><a href="../technologies/ios-application-development.html">iOS</a></li>
                                            <li><a href="../technologies/pentaho-BI-Services.html">Pentaho BI</a></li>
                                        </div>
                                        <div class="dropdown-menubox microsoft_nested">
                                            <li class="full_width"><strong>Microsoft</strong></li>
                                            <li><a href="../technologies/net-application-development.html">.Net Development</a></li>
                                            <li><a href="../technologies/microsoft-dynamics-365.html">Dynamics 365</a></li>
                                            <li><a href="../technologies/dynamics-365-business-central-solutions-development.html">Dynamics 365 Business Central</a></li>
                                            <li><a href="../technologies/dynamics365-finance-and-operations.html">Dynamics 365 Finance &amp; Operations</a></li>
                                            <li><a href="../technologies/microsoft-dynamics-crm-consulting.html">Dynamics CRM</a></li>
                                            <li><a href="#">Power BI</a></li>
                                        </div>
                                    </ul>
                                </li>
                                <li><a href="/articles/">Blog</a></li>
                                <li><a href="../contact.html" class="menu-box">Contact Us</a></li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <!-- Header Section /- -->

    <div class="b-notification-bar">
            <!-- Social Links -->
            <ul class="btnlist">
                <li class="item skype">
                    <a href="skype:aegissoftware?call">
                        <div class="sticky-box">
                            <p><i class="fa fa-skype"></i></p>
                            <p>Skype</p>
                        </div>
                    </a>
                </li>
            </ul>
            <!-- # Social Links -->

            <!-- Inquiry Form -->
            <ul class="btnlist">
                <li class="item inquiry">
                    <div id="inquiry_form" class="btn sticky-box">
                        <p><i class="fa fa-envelope" aria-hidden="true"></i></p>
                        <p>Quick Inquiry</p>
                    </div>
                    <div class="info-box inq">
                        <img src="images/close-icon.png" class="closeInquiry" alt="close" />
                        <strong class="title">Fill the details and We’ll get back to you soon</strong>
                        <form>
                            <div class="inquiry-box">
                                <div class="form-group fullwidth">
                                    <textarea class="form-control" id="txtcomments" placeholder="Tell us your requirements"></textarea>
                                </div>
                                <div class="form-group-block">
                                    <div class="form-group">
                                        <input class="form-control" id="txtphone" placeholder="Phone" type="text" onkeydown="javascript:backspacerDOWN(this, event);" onkeyup="javascript:backspacerUP(this, event);">
                                    </div>
                                    <div class="form-group">
                                        <input class="form-control" id="txtemail" placeholder="Email" type="email">
                                    </div>
                                    <div class="form-group">
                                        <input class="form-control" id="txtskype" placeholder="Skype" type="text">
                                    </div>
                                    <div class="form-group">
                                        <img id="imgCaptcha" alt="captcha" src="/Captcha.ashx" />
                                        <input class="form-control" type="text" placeholder="Captcha" id="txtCaptcha" name="txtCaptcha" />
                                    </div>
                                    <div class="form-group Clear">
                                        <button type="button" id="btnSubmit" value="Submit" name="Submit" class="btn-submit">Submit</button>
                                    </div>
                                    <div class="form-group Clear">
                                        <span id="lblInfo"> </span>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </li>
            </ul><!-- Inquiry Form /- -->
            <!--Btns-->
            <ul class="btnlist">
                <li class="item case-studies">
                    <div class="btn sticky-box" onClick="window.location.href='../casestudy/java/java-case-studies.html'">
                        <p><i class="fa fa-check-square-o" aria-hidden="true"></i></p>
                        <p>Case Studies</p>
                    </div>
                </li>
                <li class="item client-speaks">
                    <div class="btn sticky-box" onClick="window.location.href='../testimonials/java-testimonials.html'">
                        <p><i class="fa fa-smile-o" aria-hidden="true"></i></p>
                        <p>Client Speaks</p>
                    </div>
                </li>
            </ul><!--Btns-->
        </div>

    <div class="Inner-Banner">
        <div class="Page-Size">
            <h1>How to Implement Spring Cloud Bus with Examples</h1>
        </div>
    </div>

    <div class="Page-Size margh2">
        <div class="Text Width-100">
            <h2>Introduction to Spring Cloud Bus:</h2>
            <div class="single-article-img"><img src="images/Introduction-to-spring-cloud-bus.jpg" alt="Introduction to spring cloud bus"/></div>
            <p>Now, I am going to explain how we can use Spring Cloud Bus to apply configuration changes dynamically to applications while they are up and running.  I believe you will be aware of Spring cloud Config which serves sets of configuration information. The configuration file themselves can be backed by source control. Spring cloud clients connect to it automatically over HTTP and retrieve the configuration settings at start up time.</p>
            <p>But what if we have a configuration change that we need to make after an application has already been running. What if we want to increase the size of our db connection pool or increase metaspace memory or change the Logging level? The traditional approach is to repeat the Spring startup process. The solution to this problem can be “Polling”. In this Polling, our apps will periodically pull the Config server or some other source for changes. But for configuration changes, if it has to pull every time then it is not a good idea because the config changes are rare.</p>
            <p>A cleaner approach is to be to somehow push the changes out from the server to client. And this is exactly the space that Spring cloud bus addresses.</p>
            <h3>Anatomy of Spring Cloud Bus Configurations & Dependencies</h3>
            <p>Spring cloud bus is used to push configuration changes from the config server to the client applications using “Messaging Technology”. Spring cloud bus is a solution that enables a Spring Cloud Config Server to broadcast changes to spring cloud clients. So, it eliminates any needs for clients to poll the service periodically. It is based on messaging technology.</p>
            <p>Basically, the spring cloud config server publishes messages to the message broker and the client becomes the subscribers to the changes.</p>
            <p><strong>Spring Cloud Bus Setup:</strong></p>
            <p> Setting up Spring cloud bus is easy. You have to add below dependency to your Spring Cloud config server’s pom file.</p>
            <div class="single-article-img"><img src="images/img1.jpg" alt="Introduction to spring cloud bus"/></div>
            <p>On the client-side, you have to add the same above dependency. The code on the dependency is smart enough to understand that if it is on the client-side or on the server-side and it works fine. Now, this presumes that your client is otherwise unable to use the spring cloud parent.</p>
            <p>The next step is we need an AMQP(Advanced Message Queuing Protocol) server ( Such as Rabbit MQ) to provide reliable messaging. Rabbit MQ is a really nice Message broker which is open source and easy to install and run. Spring Cloud Bus works automatically with Rabbit MQ on the localhost. So, this means Spring cloud bus enabled client and server will know automatically how to connect to Rabbit MQ.</p>
            <p><strong>Broadcasting Changes:</strong></p>
            <p>So, when we have to make changes to our running application, we have to do the following things:</p>
            <p>First, we have to make changes to the relevant files in the repository.</p>
            <p>Now, when we commit the changes, there is nothing in the config server that notices these changes. It does not do any polling or listening to the repository. But, if we were to make a rest call to the config server, it would reread our file and pick up those changes.</p>
            <p>Next, we would do is that we will make a POST call to the “/bus/refresh/” endpoint on the config server. Notice that this is a post request. So, we have to use curl or some type of rest client.</p>
            <p>When the refresh is requested, the config server is going to refresh, and it is going to post a message to the message broker. The message broker ensures a delivery to all the subscribers which is basically all of our clients that have the spring-cloud-bus dependency. There are ways to fine-tune which clients get what.</p>
            <p>Then finally <a href="https://www.nexsoftsys.com/technologies/java-application-development.html" target="_blank">each individual Java application development</a> goes through its refresh process. And now I am going to explain more details about this Refresh Process.</p>
            <p><strong>How Refresh Process Works Exactly?</strong></p>
            <p>Spring boot applications can be refreshed at runtime. Spring boot contains a starter called “actuator” and this provides a number of useful web endpoints. Actuator provides an endpoint that we can sue for a health check. When we have an actuator on our classpath, we also have a refresh endpoint. Now, if we have to make a POST call to this refresh endpoint then this would be interpreted as a command to refresh the application. We can use Curl or RestTemplate for this.</p>
            <p>Our application might be up and running and processing hundreds of HTTP requests with many database connections, but the Refresh only affects the Beans that are marked with “@ConfigurationProperties” or “@RefreshScope”. The only other thing is affected is logging level. This is because logging level is something that we could change fairly often in production and there are no consequences for changing this on the fly.</p>
            <p>Now, I am explaining to you about these other two annotations “@ConfigurationProperties” and “@RefreshScope”</p>
            <p><strong>@ConfigurationProperties Example</strong></p>
            <p> This annotation is not new, but it comes to us from spring boot. It is an easy way to set multiple properties quickly instead of putting the value annotations on each one. So, if we have a dozen variables to set using “@Value” annotation, this can get really old and fast.</p>
            <p> So, instead, if we annotate the entire class with “@ConfigurationProperties” annotation and supply a prefix and provide a setter method, then Spring boot at startup time, automatically populate these properties with corresponding values from the property source that match the prefix and name of the property. Please see the example code below:</p>
            <div class="single-article-img"><img src="images/img2.jpg" alt="Introduction to spring cloud bus"/></div>
            <p>In our YAML file, there will be a section that will match the prefix that we are using here in the above code. Also, it will match the properties line up what we need to set. Extra properties would be ignored and anything without the setter method would be ignored. YAML file will look like as below:</p>
            <div class="single-article-img"><img src="images/img3.jpg" alt="Introduction to spring cloud bus"/></div>
            <p>You can see that the spelling of the “name” in the above yaml file is not matching with the properties that we have set in the code (name). This is ok. This is called “Relax Binding”. Spring boot understands what we mean here. Camel's case will also be ok, and all caps letters would also match this property without any issue.</p>
            <p>Now, if we do a POST call to “/refresh” url, then any beans with @ConfigurationProperties properties will have their properties rebound. But still, there is a limitation here. It is not enough just to reset those properties. But instead, we might have some initialization logic that needs to be rerun. Now, for our “ProfileController” example here, rebinding the properties is completely fine. Because the property is just used in the controller. Now, something new got introduced in spring cloud but not in spring boot is “Refresh scope”.</p>
            <p><strong>@RefreshScope Example</strong></p>
            <p>RefreshScope gives us the ability to safely incompletely reload the bean without having to worry about the effect that it will have on the other beans that are presently referencing. Refresh scope allows for hot-swapping of old and new copies of the bean at runtime. So, when we make a POST call to refresh, the entire bean is reloaded. It is not limited to property rebinding like the case of @ConfigurationProperties. Now it is reloaded in a Safeway. Please see below the snippet of code:</p>
            <div class="single-article-img"><img src="images/img4.jpg" alt="Introduction to spring cloud bus"/></div>
            <p> The side effect of the refresh scope is that the bean becomes lazy meaning that it is not reloaded until the first time that it is used. This is ok but any configuration issues or any post construct issues will not be discovered until the first time the bean is used. Now, you can see from the above code that our bean uses @RefreshScope. You can also see that I can reverted to “@Value” annotation. We can use also @ConfigurationProperties with @RefreshScope. With the @Value annotation, I do not need getters and Setters methods, but I will lose here the “Relax Property Binding” that is provided by Spring boot.</p>
            <p> Refresh scope works by using the Proxy pattern and it is one of the useful use cases for the Proxy pattern. When the application context loads, Spring creates a proxy for the actual target bean. The proxy either implements the same interface as the target bean or it extends it depending upon the whether an interface is present on a target Bean. It has the same method signature as the Target Bean.</p>
            <p>Main point is that the proxy looks exactly like the Target Bean to anyone referencing the it from outside. Now when we do dependency injection, other beans do not get the original bean but then get a reference to the Proxy. When the caller makes a method call, the proxy simply turns around and calls a method on the original bean.</p>
            <p> Now on refresh what happens is a new replacement bean is created and the target reference on the proxy is switched to the replacement. That means on refresh, the “target” bean is changed to the newly created bean. Older bean is dereferenced. Any calls to the original bean that are currently executing are unaffected. But any future calls to the method will go to the new bean. Please look at the below diagram for better understanding:</p>
            <div class="single-article-img"><img src="images/img5.jpg" alt="Introduction to spring cloud bus"/></div>
            <p>So, the beauty of the refresh scope is that the proxy makes it safe for the existing threads to finish up whatever they are working on while the future gets switched over to the new version.</p>
            <p>Now, we will implement this in our example demo. I am going to setup our spring cloud config server to use Spring cloud bus and also I am going to setup Rabbit MQ.</p>
            <h3>Demo on Spring Cloud Bus:</h3>
            <p><strong>Setup the Message Broker:</strong></p>
            <ul class="listing">
                <li>1.  First, we have to setup our Rabbit MQ broker. You can download it from internet.</li>
                <li>2.  Start the Rabbit MQ and leave it in the running state.</li>
            </ul>
            <p><strong>Setup the Server Application:</strong></p>
            <ul class="listing">
                <li>3.  Create a Simple Spring boot server application called “demo-config-server”  and in the POM file of the application, you have to add the “spring-cloud-starter-bus-amqp” dependency to include the cloud bus. Example:
                    <div class="single-article-img"><img src="images/img6.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>
                    4.  Now, go to your “application.yml” file and edit the file with your config server git url. I have set the “server.port” to 8001. In this application yaml file, the spring cloud config server is using a git URI so that it will go out to GitHub to obtain the config. Information. When the Native profile is active, then "native" is used for local testing with a classpath repositories. Also, we have to add  the entry for “management.endpoints.web.exposure.include: bus-refresh” . This permits external parties’ POST requests to trigger the refresh.
                    <div class="single-article-img"><img src="images/img7.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>
                    5.   Then you have to create your main application configuration class with “@EnableConfigServer” annotation. Example:
                    <div class="single-article-img"><img src="images/img8.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>6.  Now, save all your changes and run the demo-config-server application.</li>
            </ul>
            <p><strong>Setup the Client Application:</strong></p>
            <ul class="listing">
                <li>7.  Create a Simple Spring boot server application called “demo-client-app”  and in the POM file of the application, you have to add the “spring-cloud-starter-bus-amqp” dependency to include the cloud bus.</li>
                <li>8.  Now, create a Rest Controller class called “ProfileController.java” and add a @ConfigurationProperties annotation with a prefix of “profile-config”. I have created two fields (desc and name for profile ) and also added getter/setter Method for those values. Example:
                    <div class="single-article-img"><img src="images/img9.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>
                    9.  Create your bootstrap.yml. I have given the application name as “profile-client”. Now, I will mention the file i.e. required in our Git repository to hold properties for this application. Example:
                    <div class="single-article-img"><img src="images/img10.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>
                    10. Now, in your Git repository, create a profile-client.yml file. Then add a level for “profileConfig:” and entries within it for “name:” and “desc:” Add a value for name, something like “Rakesh” or “Harsh” or “Krish”. For “desc”, you have to add a value such as “The name of the profile is”. Now, save your files and issue commit command to the repository. Example:       
                    <div class="single-article-img"><img src="images/img11.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>11. Now, start your “demo-client-app” n that we just created above. ( You have to create the Main application main class to run the spring boot application. I have skipped that as that is a very common and basic step for every application.)</li>
            </ul>
            <p><strong>Test our application:</strong></p>
            <ul class="listing">
                <li>12. Open any browser and access the URL to “<a href="javascript:;">http://localhost:8002/profile</a>”. Then You should see output such as “The name of the profile is: Krish”.</li>
            </ul>
            <p><strong>Testing Configuration Changes</strong></p>
            <ul class="listing">
                <li>13. Now, again we will go to your Git repository and modify our profile-client.yml file. I am modifying the “name: Krish” to some other values(“name: Ayush”). Save the file and commit. The interesting thing is Will this new change that I did now will be visible if I refresh this URL “<a href="javascript:;">http://localhost:8002/profile</a>“? Why our changes will not reflect?</li>
                <li>14. Now, I will have to make a POST request to “<a href="javascript:;">http://localhost:8001/actuator/bus-refresh</a>”. You can do post requests using a “curl” command in Linux  (curl --request POST <URL>), or you can use “POSTMAN” tool.</li>
                <li>15. Then after step 14, we have to refresh this URL <a href="javascript:;">http://localhost:8002/profile</a>”. Now our new changes should be visible. This is due to the Spring Cloud Bus.</li>
            </ul>
            <p><strong>Implementation of @RefreshScope</strong></p>
            <ul class="listing">
                <li>16. Let’s create another controller class called(ProfileController2.java) inside of our demo-client-app project. Add the @RefreshScope annotation to the controller class. Example:
                    <div class="single-article-img"><img src="images/img12.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>
                    17. Now, you can test this refresh scope by writing a Junit class using @SpringBootTest annotation. And you can pass the “name” and “desc” property using @TestPropertySource annotation. Example:
                    <div class="single-article-img"><img src="images/img13.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>18. Now, you can open a browser and verify our application by accessing the URL <a href="javascript:;">http://localhost:8002/profile</a>. You can keep on changing the value of name and desc properties through your JUnit class and then access the URL and verify if your changes reflect or not. This will work with the Refresh scope.</li>
            </ul>
            <h3>API Gateway: Spring Cloud</h3>
            <p>I am going to explain to you about the API Gateway and about Spring Cloud Zuul and show you how it can be used to easily implement the basic routing.</p>
            <p><strong>The need for an API Gateway:</strong></p>
            <p>Let’s assume about the applications that we have implemented will look like the below structure:</p>
            <div class="single-article-img"><img src="images/img14.jpg" alt="Introduction to spring cloud bus"/></div>
            <p>We have introduced lots of concepts like Eureka and Config server to help with services find each other, configure themselves, update themselves and call each other. This works fine with the assumption that our network is a high speed and secure and that bandwidth is unlimited, and latency is zero. But always you cannot assume a fast-secure network. So, we have to make some improvements.</p>
            <p>In the above diagram, our services are being called over the public internet. There can be several concerns. First, we are exposing our internal API over the public internet and we do not want to do this. So, we will have to add security but that will mean our clients which is a web page (in my example) will have to authenticate with five different servers and we have a cross-origin resource sharing issues which we must address. This is because all browsers will have a built-in security precaution which disallows JavaScript calls to domains other than the one from which they are originated. So, we can get around this CORS issue.</p>
            <p>Another fundamental issue is that multiple HTTP calls are made to get each sentence in the above example diagram. The client needs to get the response back in a jiffy.</p>
            <p>We could have dissimilar client having different needs. What if some of the services are not relevant for some of the clients. The issue here is that the Microservice are built to be focused and simple, but the clients have specific needs to assemble the content or use the services in the ways that our services should not have to concern themselves with. We need something in between like Adapter. So that can serve the clients directly by taking care of the various backend calls on their behalf. This is exactly where the “API Gateway” fits in.</p>
            <h3>API Gateway Fundamentals</h3>
            <ul class="listing">
                <li>An API Gateway provides a server-side backend i.e. custom made for the needs of the client applications. It simplifies their access needs by providing a single point of contact for calling into the backend Microservice. It provides an API customized specifically for what the client needs. It provides a single place in the architecture where the security can be applied at least for authentication purposes. It eliminates the CORS issues because we have only one domain on the backend as far as the client is concerned.</li>
                <li>Also, we can reduce the number of trips to the backend if we have the gateway consolidate several individual backend calls into one call. We can implement the caching in the API gateway. We can one Gateway or more than one also depending on the client's needs. If clients are identical then one gateway would be fine.</li>
                <li>So, the API gateway is built to address the remote client needs. It is a one-stop-shop for the client to access. It serves a façade to the real API. API gateway lives on the server-side. It reduces the number of remote calls. API gateway routes the call to the real backend services, and it handles security and caching. Also, an API gateway can handle protocol translation. This means that Microservice might be set up to work with messaging protocols or TCP or some other protocols other than HTTP.</li>
                <li>The API Gateway would take care of taking the client HTTP request, putting into a message and waiting for a reply message and returning a response. The client application does not need to deal with any of the messaging APIs. The API Gateway can also optimize calls to the backend API by expanding the hyperlinks found within restful resources.</li>
                <li>So, the API Gateway is a key piece to the Microservices Architecture at least from the client’s perspective. Now, I am going to explain to you the options for implementing the API Gateway. We can use Zuul from Netflix to implement the API gateway in our application. Spring cloud provides an easy way to use Zuul.</li>
                <li>Zuul can serve as a router and a load balancer. The routing is going to easily take care of some of our API Gateway needs. Routing means a client can make a request that goes to the API gateway. And Gateway will immediately send that request to the real server that is responsible for it. This is also known as a reverse proxy as we are proxy and calls to various backend services.</li>
            </ul>
            <p><strong>ZUUL Basic usage:</strong></p>
            <ul class="listing">
                <li>It is easy to make our own Zuul server. Just we have to make a spring boot application with “spring-cloud-starter-zuul”. All needed dependencies will be brought in including Ribbon and Hystrix circuit breaker. We only need one annotation to switch the Zuul on. This annotation is “@EnableZuulProxy”. The default behavior is that it registers itself with Eureka along with all of the other clients which of course implies that it is configured with the URL to Eureka. And it also collects all the client ids reported by Eureka. The client ids are used to build URIs to the actual backend services.</li>
                <li>So, in our example, Zuul would collect the service IDs and find one called “Subject”. It would then find a URL mapping to “/subject” that would call the subject service. The verb service(“/verb”) would be encountered and it would set up a url mapping to the “verb” service and any traffic sent to those url mappings would be immediately routed to real service. Since “Gribben” is involved here, the calls are automatically loaded balanced whenever there is more than one backend service available for a given type. And also, above that, since Hystrix is also involved, so each call is made within a Hystrix command and so we get simple circuit breaker behavior.</li>
                <li>When we start up a Zuul proxy server and you can take a look at the below image closely.
                    <div class="single-article-img"><img src="images/img15.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>You can see what it is doing behind the scenes. After it registers with Eureka and learns all of the client names, it defines Spring MVC handler mappings. See the above image. What it is saying is that the URL pattern for the “/article/**” and “/verb/**” and the others are mapped to a special controller called the “ZuulController”. This controller is provided by the framework and the logic within it simply turns around and around and calls the actual  Eureka identified servers.</li>
                <li>Now assuming that the Zuul proxy server is running on localhost 8080, a request for “/subject” would be routed to wherever the subject server service is running. Then now how the Zuul proxy server knows where the subject server is running? It finds that from Eureka.</li>
            </ul>
            <p><strong>Zuul Features:</strong></p>
            <ul class="listing">
                <li>Zuul proxy that wraps client calls to the actual backend services. We can also exclude services as we might not want to expose all services known to Eureka. By default, all Eureka services are available for routing. Simply list out which services you want to ignore, and they will be blacklisted.</li>
                <li> You can backlist everything by setting “zuul.ignored-services = *”. And then you can explicitly whitelist the Eureka client IDs that you want to provide routing to. You can also provide a prefix using “zuul.prefix”. This is a good way to distinguish backend services from any others defined explicitly by the Gateway itself. Also, you can adjust the URL. Please see the sample yaml file:
                    <div class="single-article-img"><img src="images/img16.jpg" alt="Introduction to spring cloud bus"/></div>
                </li>
                <li>In the above yaml file, I have added the “/api” prefix and told Zuul that calls to the “verb” service should not be forwarded. Also, the URL pattern to access the Subject and Noun Services should be altered from the default to be “/sentence-subject/**” and “/sentence-noun/**” respectively.</li>
            </ul>
            <h3>Conclusion</h3>
            <p>Here, I have explained to you about the real-time implementations of Spring cloud bus with Eureka and config server. If you are not familiar with Eureka and Config Server, then please read our specific blogs on Eureka and Config Server. Try to implement yourself as the API gateway in your project. You can also read our more advance blogs to learn about the implementation of the Spring API Gateway.</p>
            <h3>References</h3>
            <ul class="listing">
                <li><a href="https://cloud.spring.io/spring-cloud-bus/reference/html/" target="_blank">https://cloud.spring.io/spring-cloud-bus/reference/html/</a></li>
                <li><a href="https://spring.io/projects/spring-cloud-gateway" target="_blank">https://spring.io/projects/spring-cloud-gateway</a></li>
            </ul>
            <!-- # -->
        </div>
    

</div>

<div id="nss-note"><img src="../images/nss.jpg" alt="NSS Note" /></div>
<div class="clients-section margin_top30">
        <div class="section-header ourclients">
            <h4>Some of our clients</h4>
        </div>
        <div class="container">
            <div class="clients-block owl-carousel owl-theme">
                <div class="item client1"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client2"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client3"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client4"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client5"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client8"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client9"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client10"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client11"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client15"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client16"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client17"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client12"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client13"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client14"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client6"><img src="../images/spacer.gif" alt="client" /></div>
                <div class="item client7"><img src="../images/spacer.gif" alt="client" /></div>
            </div>
        </div>
    </div>
    <div class="teams-section">
        <div class="container">
            <div class="teams-title">
                <img data-src="../images/team-title.svg" class="lazyload" alt="team" />
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer-main">
        <div class="container">
            <div class="row">
                <div class="footer-box">
                    <h3>Services</h3>
                    <div class="footer-innerbox-block">
                        <div class="footer-innerbox">
                            <ul class="listing">
                                <li><a href="../services/application-development.html">Application Development</a></li>
                                <li><a href="#">Digital Transformation</a></li>
                                <li><a href="../services/software-consulting-services.html">Software Consulting Services</a></li>
                                <li><a href="../services/software-it-outsourcing-services.html">Software IT Outsourcing</a></li>
                                <li><a href="../services/offshore-development-center.html">Offshore Development</a></li>
                                <li><a href="../services/big-data-services.html">Big Data</a></li>
                                <li><a href="../services/real-time-data-analytics-services.html">Real Time Analytics</a></li>
                                <li><a href="#">Block Chain</a></li>
                                <li><a href="../services/devops-consulting.html">DevOps</a></li>
                            </ul>
                        </div>
                        <div class="footer-innerbox">
                            <ul class="listing">
                                <li><a href="../services/offshore-qa-testing-services.html">QA and Testing Services</a></li>
                                <li><a href="../services/amazon-cloud-services.html">Amazon Cloud Services</a></li>
                                <li><a href="../services/cloud-application-development.html">Cloud Application</a></li>
                                <li><a href="../services/mobility-solutions.html">Enterprise Mobility</a></li>
                                <li><a href="#">Business Intelligence</a></li>
                                <li><a href="../services/data-warehousing-solutions.html">Data ware Housing</a></li>
                                <li><a href="#">Data Integration</a></li>
                                <li><a href="../services/ETL-data-integration-services.html">ETL</a></li>
                                <li><a href="#">Dashboards</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="footer-box">
                    <h3>Technologies</h3>
                    <div class="footer-innerbox w35">
                        <ul class="listing">
                            <li><a href="../technologies/java-application-development.html">Java</a></li>
                            <li><a href="../technologies/python-development-services.html">Python</a></li>
                            <li><a href="../technologies/scala-development.html">Scala</a></li>
                            <li><a href="../technologies/magento-ecommerce.html">Magento</a></li>
                            <li><a href="../technologies/android-app-development.html">Android</a></li>
                            <li><a href="../technologies/ios-application-development.html">iOS</a></li>
                            <li><a href="../technologies/pentaho-BI-Services.html">Pentaho BI</a></li>
                        </ul>
                    </div>
                    <div class="footer-innerbox w65">
                        <ul class="listing">
                            <li class="list-title"><strong>Microsoft</strong></li>
                            <li><a href="../technologies/net-application-development.html">.Net Development</a></li>
                            <li><a href="../technologies/microsoft-dynamics-365.html">Dynamics 365</a></li>
                            <li><a href="../technologies/dynamics-365-business-central-solutions-development.html">Dynamics 365 Business Central</a></li>
                            <li><a href="../technologies/dynamics365-finance-and-operations.html">Dynamics 365 Finance &amp; Operations</a></li>
                            <li><a href="../technologies/microsoft-dynamics-crm-consulting.html">Dynamics CRM</a></li>
                            <li><a href="#">Power BI</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-box footer_sm">
                    <div class="footer-box-business">
                        <h3>Business with us</h3>
                        <ul class="listing">
                            <li><a href="../company.html">Company</a></li>
                            <li><a href="../contact.html">Contact Us</a></li>
                            <li><a href="../careers.html">Careers</a></li>
                            <li><a href="/articles/">Blog</a></li>
                            <li><a href="mailto:info@nexsoftsys.com">Mail Us</a></li>
                        </ul>
                        <div class="footer-socialbox">
                            <h3>Follow NEX</h3>
                            <div class="ft-social">
                                <a href="https://www.facebook.com/NexSoftSys/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                                <a href="https://twitter.com/nexsoftsys" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                                <a href="https://www.linkedin.com/company/nexsoftware/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
                                <a href="https://www.youtube.com/c/Nexsoftsys" target="_blank"><i class="fa fa-youtube-play" aria-hidden="true"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            <div class="ast"><p>An Aegis Group Company</p><span></span></div>
            </div>
        </div>
        <div class="copyright_text">
            <div class="copyright_text">
                <div class="container footer-rating">
                    <p>Copyright &copy; <span id="year"></span> NEX Software All rights reserved</p>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer /- -->

    <script defer src="../js/jquery-1.12.4.min.js"></script>
    <script defer src="../js/lib.js"></script>
    <script defer src="js/functions.js"></script>

    
</body>

</html>